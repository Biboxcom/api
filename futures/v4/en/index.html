
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Bibox API Document(v4)</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sa, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-4f67ce97.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-628c1a7f.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e033bdd3.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;,&quot;python&quot;,&quot;csharp&quot;]">
    <a href="#" id="nav-button">
      <span>
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <header>
      <div class="flex_box">
        <img src="images/logo-5720d610.png" class="logo" id="bibox-logo" alt="" />
        <div class="nav_box">
          <span id="spot_select" class="nav-select">
            <span id="btn_spot-select">
              现货
            </span>

            <span class="nav-select-drop">
              <a href="/api/spot/v4/zh/" class="nav-select-item" id="btn_spot_v4">现货v4</a>
              <a href="/api/spot/v3/zh/" class="nav-select-item" id="btn_spot">现货v3</a>
            </span>
          </span>
          <span class="nav-select">
            <span id="btn_contract-select">
              U本位永续合约
            </span>

            <span class="nav-select-drop big">
              <a href="/api/futures/v4/zh/" class="nav-select-item" id="btn_contract_v4">U本位永续合约 v4</a>
              <a href="/api/futures/v3/zh/" class="nav-select-item" id="btn_contract_v3">U本位永续合约 v3</a>
            </span>
          </span>
          <span class="nav_cell nav_tab">
            <a href="/api/futures-coin/v3/zh/" id="btn_contract_coin">币本位永续合约</a>
          </span>
        </div>
      </div>
      <a href="/api/spot/v3/en/" class="lang" id="lang_box">English</a>
    </header>
    <div class="toc-wrapper">
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="csharp">csharp</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#basic-information" class="toc-h1 toc-link" data-title="Basic Information">Basic Information</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#futures-udst-m-api" class="toc-h2 toc-link" data-title="Futures UDST-M API">Futures UDST-M API</a>
                  </li>
                  <li>
                    <a href="#traffic-restrictions" class="toc-h2 toc-link" data-title="Traffic Restrictions">Traffic Restrictions</a>
                  </li>
                  <li>
                    <a href="#authentication" class="toc-h2 toc-link" data-title="Authentication">Authentication</a>
                  </li>
                  <li>
                    <a href="#api-key-permissions" class="toc-h2 toc-link" data-title="Api Key permissions">Api Key permissions</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#market-data-endpoints" class="toc-h1 toc-link" data-title="Market Data Endpoints">Market Data Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-timestamp" class="toc-h2 toc-link" data-title="Get Timestamp">Get Timestamp</a>
                  </li>
                  <li>
                    <a href="#get-listed-pairs" class="toc-h2 toc-link" data-title="Get Listed Pairs">Get Listed Pairs</a>
                  </li>
                  <li>
                    <a href="#get-order-book" class="toc-h2 toc-link" data-title="Get Order Book">Get Order Book</a>
                  </li>
                  <li>
                    <a href="#get-candles" class="toc-h2 toc-link" data-title="Get Candles">Get Candles</a>
                  </li>
                  <li>
                    <a href="#get-tagprices" class="toc-h2 toc-link" data-title="Get TagPrices">Get TagPrices</a>
                  </li>
                  <li>
                    <a href="#get-indices" class="toc-h2 toc-link" data-title="Get Indices">Get Indices</a>
                  </li>
                  <li>
                    <a href="#get-trades" class="toc-h2 toc-link" data-title="Get Trades">Get Trades</a>
                  </li>
                  <li>
                    <a href="#get-tickers" class="toc-h2 toc-link" data-title="Get Tickers">Get Tickers</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#market-data-streams" class="toc-h1 toc-link" data-title="Market Data Streams">Market Data Streams</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#request-methods" class="toc-h2 toc-link" data-title="Request Methods">Request Methods</a>
                  </li>
                  <li>
                    <a href="#subscribe-order-book" class="toc-h2 toc-link" data-title="Subscribe Order Book">Subscribe Order Book</a>
                  </li>
                  <li>
                    <a href="#subscribe-trades" class="toc-h2 toc-link" data-title="Subscribe Trades">Subscribe Trades</a>
                  </li>
                  <li>
                    <a href="#subscribe-candles" class="toc-h2 toc-link" data-title="Subscribe Candles">Subscribe Candles</a>
                  </li>
                  <li>
                    <a href="#subscribe-tickers" class="toc-h2 toc-link" data-title="Subscribe Tickers">Subscribe Tickers</a>
                  </li>
                  <li>
                    <a href="#subscribe-indices" class="toc-h2 toc-link" data-title="Subscribe Indices">Subscribe Indices</a>
                  </li>
                  <li>
                    <a href="#subscribe-tag-prices" class="toc-h2 toc-link" data-title="Subscribe Tag Prices">Subscribe Tag Prices</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#user-data-endpoints" class="toc-h1 toc-link" data-title="User Data Endpoints">User Data Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-accounts" class="toc-h2 toc-link" data-title="Get Accounts">Get Accounts</a>
                  </li>
                  <li>
                    <a href="#get-an-account-39-s-ledger" class="toc-h2 toc-link" data-title="Get an account's ledger">Get an account's ledger</a>
                  </li>
                  <li>
                    <a href="#create-an-order" class="toc-h2 toc-link" data-title="Create an order">Create an order</a>
                  </li>
                  <li>
                    <a href="#get-an-order" class="toc-h2 toc-link" data-title="Get an order">Get an order</a>
                  </li>
                  <li>
                    <a href="#get-orders" class="toc-h2 toc-link" data-title="Get Orders">Get Orders</a>
                  </li>
                  <li>
                    <a href="#cancel-orders" class="toc-h2 toc-link" data-title="Cancel Orders">Cancel Orders</a>
                  </li>
                  <li>
                    <a href="#cancel-all-orders" class="toc-h2 toc-link" data-title="Cancel all Orders">Cancel all Orders</a>
                  </li>
                  <li>
                    <a href="#get-fills" class="toc-h2 toc-link" data-title="Get fills">Get fills</a>
                  </li>
                  <li>
                    <a href="#create-an-plan-order" class="toc-h2 toc-link" data-title="Create an plan order">Create an plan order</a>
                  </li>
                  <li>
                    <a href="#edit-an-plan-order" class="toc-h2 toc-link" data-title="Edit an plan order">Edit an plan order</a>
                  </li>
                  <li>
                    <a href="#cancel-plan-orders" class="toc-h2 toc-link" data-title="Cancel Plan Orders">Cancel Plan Orders</a>
                  </li>
                  <li>
                    <a href="#cancel-all-plan-orders" class="toc-h2 toc-link" data-title="Cancel all Plan Orders">Cancel all Plan Orders</a>
                  </li>
                  <li>
                    <a href="#get-plan-orders" class="toc-h2 toc-link" data-title="Get Plan Orders">Get Plan Orders</a>
                  </li>
                  <li>
                    <a href="#get-positions" class="toc-h2 toc-link" data-title="Get Positions">Get Positions</a>
                  </li>
                  <li>
                    <a href="#change-position-mode" class="toc-h2 toc-link" data-title="Change Position Mode">Change Position Mode</a>
                  </li>
                  <li>
                    <a href="#change-position-margin" class="toc-h2 toc-link" data-title="Change Position Margin">Change Position Margin</a>
                  </li>
                  <li>
                    <a href="#clear-position-hold" class="toc-h2 toc-link" data-title="Clear Position Hold">Clear Position Hold</a>
                  </li>
                  <li>
                    <a href="#oppose-position" class="toc-h2 toc-link" data-title="Oppose Position">Oppose Position</a>
                  </li>
                  <li>
                    <a href="#get-position-logs" class="toc-h2 toc-link" data-title="Get Position Logs">Get Position Logs</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#user-data-streams" class="toc-h1 toc-link" data-title="User Data Streams">User Data Streams</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview-2" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#account" class="toc-h2 toc-link" data-title="Account">Account</a>
                  </li>
                  <li>
                    <a href="#orders" class="toc-h2 toc-link" data-title="Orders">Orders</a>
                  </li>
                  <li>
                    <a href="#positions" class="toc-h2 toc-link" data-title="Positions">Positions</a>
                  </li>
                  <li>
                    <a href="#plan-orders" class="toc-h2 toc-link" data-title="Plan Orders">Plan Orders</a>
                  </li>
                  <li>
                    <a href="#fills" class="toc-h2 toc-link" data-title="Fills">Fills</a>
                  </li>
                  <li>
                    <a href="#ledgers" class="toc-h2 toc-link" data-title="Ledgers">Ledgers</a>
                  </li>
                  <li>
                    <a href="#deallogs" class="toc-h2 toc-link" data-title="DealLogs">DealLogs</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#e08c1d4f9a" class="toc-h2 toc-link" data-title="错误码">错误码</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://www.bibox.com'>start trading</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='basic-information'>Basic Information</h1><h2 id='futures-udst-m-api'>Futures UDST-M API</h2>
<p><strong>Using the Futures UDST-M API to develop applications, you can accurately obtain market data of the Bibox spot market and conduct automated transactions quickly. The Futures UDST-M API contains many interfaces, which are roughly divided into the following groups according to their functions：</strong></p>

<ul>
<li>Market Data Endpoints REST interface for obtaining market data</li>
<li>User Data Endpoints REST interface for obtaining user private data</li>
<li>Market Data Streams WebSocket interface for obtaining market data</li>
<li>User Data Streams WebSocket interface for obtaining user private data</li>
</ul>

<p><strong>Futures UDST-M API usage is as followsBase URL：</strong></p>

<ul>
<li>Market Data Endpoints: https://api.bibox.com/api</li>
<li>User Data Endpoints: https://api.bibox.com/api</li>
<li>Market Data Stream: wss://market-wss.bibox360.com/cbu</li>
<li>User Data Stream: wss://user-wss.bibox360.com/cbu</li>
</ul>

<p><strong>List of alternate API domains</strong></p>

<p><a href="https://api.bibox.tel/v1/public/queryApiDomain">https://api.bibox.tel/v1/public/queryApiDomain</a></p>

<p><strong>The REST interface of the Futures UDST-M API uses the following HTTP methods：</strong></p>

<ul>
<li>GET Used to get market data or private data</li>
<li>POST Used to submit orders and other operations</li>
<li>DELETE Used to revoke orders and other operations</li>
</ul>

<p><strong>Parameters required by the REST interface of the Futures UDST-M API should be appended to the request according to the following rules：</strong></p>

<ul>
<li>Interface parameters of type GET should be appended to the Query String</li>
<li>The interface parameters of the POST type should be appended to the Request Body in JSON format</li>
<li>Interface parameters of type DELETE should be appended to Request Body in JSON format</li>
</ul>

<p><strong>Response</strong></p>

<p>The response data of the Futures UDST-M API is returned in JSON format. For the specific format, please refer to the description of each interface.</p>

<p><strong>Error</strong></p>

<p>Errors from the Futures UDST-M API are returned in the following JSON format：</p>

<p>{<br/>
&nbsp;&nbsp;&quot;error&quot;: error code,<br/>
&nbsp;&nbsp;&quot;message&quot;: &quot;error message&quot;<br/>
}</p>

<p><em>Among them, error indicates the type of error, and message contains the cause of the error or a hint on how to avoid the error. For specific error types, please refer to the <a href="#errors">Error</a> chapter.</em></p>

<p><strong>Time or Timestamp</strong></p>

<p>The time values involved in the interface parameters and response data of the Futures UDST-M API are all UNIX time in milliseconds.</p>

<hr>
<h2 id='traffic-restrictions'>Traffic Restrictions</h2>
<p><strong>Bibox imposes the following access restrictions on requests from the same IP:</strong></p>

<ol>
<li>Access Limits</li>
<li>Usage Limits CPU usage limit</li>
</ol>

<ul>
<li>Access Limits Access frequency limit

<ol>
<li>The same IP has a maximum of 10000 requests every 10 seconds, and requests that exceed the limit will receive a -2101 error.</li>
<li>The user can send up to 10,000 requests at any frequency within 10 seconds as needed, either roughly every 10ms, or 10,000 consecutive times within 1 second, then wait 9 seconds.
<br/>
<br/></li>
</ol></li>
<li>Usage Limits

<ol>
<li>The same IP consumes up to 10,000 CPU points every 10 seconds, and requests that exceed the limit will receive a -2102 error.</li>
<li>Different APIs consume different CPU time, depending on how the API accesses the data.</li>
<li>In this article, the way each API interface accesses data will be indicated in the form of &quot;cache&quot; and &quot;database&quot;. API that accesses the cache consumes less CPU time, and API that accesses the database consumes more CPU time. Depending on the parameters sent by the user, the API may access the cache and database in a mix, or even access the database multiple times, which will increase the CPU time consumed by the API.</li>
<li>The CPU time consumed by each API request will be included in the response header Bibox-Usage in the format t1:t2:t3, where t1 represents the CPU time consumed by this API request, and t2 represents the current IP consumption in the last 10 seconds CPU time, t3 represents the remaining available CPU time of the current IP in the last 10 seconds.</li>
</ol></li>
</ul>

<hr>
<h2 id='authentication'>Authentication</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span> <span class="c1">// POST or DELETE  replace queryStr with bodyStr</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/accounts?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span> <span class="c1">// optional</span>
          <span class="p">},</span>
        <span class="p">},</span>

        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/accounts'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=USDT'</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span> <span class="o">//</span> <span class="n">optional</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/accounts"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"asset=USDT"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<p><strong>Authentication</strong></p>

<ul>
<li>The private interface is used to access private information such as accounts and delegations. Additional signatures are required when requesting to satisfy Bibox for authentication. This section describes how to create a signature.</li>
</ul>

<p><strong>Generate Api Key</strong></p>

<ul>
<li>To create a signature, you first need to generate a combination of Api Key and Secret Key. Please keep in mind the Secret Key generated during this process, as this value is only displayed once, if you forget the Secret Key, delete the Api Key and generate a new Api Key and Secret Key combination.</li>
</ul>

<p><strong>HTTP request headers</strong></p>

<p><strong>Requests to access private interfaces must append the following HTTP request headers:</strong></p>

<ul>
<li>Bibox-Api-Key generated Api Key</li>
<li>Bibox-Api-Sign signature</li>
</ul>

<p><strong>The following HTTP request headers can also be appended if desired:</strong></p>

<ul>
<li>Bibox-Expire-Time

<ol>
<li>Interface expiration time.</li>
<li>The value is Unix time in milliseconds. The server will ignore requests received after this time. This is mainly used to avoid the impact of network delays.</li>
<li>The expiration time is limited to the next 60 seconds.</li>
</ol></li>
</ul>

<p><strong>Create signature</strong></p>

<p>Before sending the request, first determine the message body for signing. For GET type requests, the expiration time plus Query String is the message body that needs to be signed (expireTime: queryString). For POST and DELETE type requests, the expiration time plus Body String is the message body that needs to be signed (expireTime: bodyString). The specific method of signing is as follows:</p>

<ul>
<li>Step 1: Use the Secret Key as the key to execute the HmacSHA256 algorithm on the message body that needs to be signed</li>
<li>Step 2: Convert the above result to Hex String</li>
<li>Step 3: Use Hex String as the value of the request header Bibox-Api-Sign</li>
</ul>
<h2 id='api-key-permissions'>Api Key permissions</h2>
<p>*<em>Private interfaces require specific permissions to execute. Appropriate permissions can be granted to the Api Key. If the Api Key is not granted the permissions required by an interface, then requests submitted using that Api Key will be rejected. *</em></p>

<p><strong>The following permissions can be granted to Api Key:</strong></p>

<ul>
<li>View permission allows Api Key to get private data.</li>
<li>Trade permission allows Api Key to submit or revoke delegation, and allows Api Key to obtain transaction-related data.</li>
</ul>

<p>*The permissions required by the interface will be given in the description of each interface. *</p>

<hr>
<h1 id='market-data-endpoints'>Market Data Endpoints</h1><h2 id='get-timestamp'>Get Timestamp</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/timestamp</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/timestamp'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/timestamp"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="s2">"1653618929241"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Get server time</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/timestamp</li>
<li>Data source</li>
</ul>

<p>Cache</p>
<h2 id='get-listed-pairs'>Get Listed Pairs</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/pairs?symbol=4BTC_USDT</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/pairs?symbol=4BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/pairs"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
     </span><span class="nl">"symbol"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">trading</span><span class="w"> </span><span class="err">pair</span><span class="w"> </span><span class="err">name</span><span class="w">
     </span><span class="nl">"base"</span><span class="p">:</span><span class="s2">"BTC"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"quote"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">quote</span><span class="w"> </span><span class="err">currency</span><span class="w">
     </span><span class="nl">"price_scale"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">decimal</span><span class="w"> </span><span class="err">places</span><span class="w">
     </span><span class="nl">"quantity_min"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">minimum</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">quantity</span><span class="w"> </span><span class="err">(coin)</span><span class="w">
     </span><span class="nl">"quantity_max"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">maximum</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">quantity</span><span class="w"> </span><span class="err">(coin)</span><span class="w">
     </span><span class="nl">"quantity_increment"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">increment</span><span class="w"> </span><span class="err">(coin)</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get a list of currencies</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/pairs</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>No</td>
<td>Trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.<br/>Multiple trading pair codes can be specified as follows<br/> /pairs?symbol=4BTC_USDT,4ETH_USDT<br/> If not specified symbol parameter, it returns the information of all trading pairs</td>
</tr>
</tbody></table>

<ul>
<li>Data source</li>
</ul>

<p>Cache</p>
<h2 id='get-order-book'>Get Order Book</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/order_book?symbol=4BTC_USDT</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/order_book?symbol=4BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/order_book"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
     </span><span class="nl">"i"</span><span class="p">:</span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
     </span><span class="nl">"t"</span><span class="p">:</span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="p">,</span><span class="w">
     </span><span class="nl">"b"</span><span class="p">:[</span><span class="w"> </span><span class="err">buy</span><span class="w"> </span><span class="err">order</span><span class="w">
         </span><span class="p">[</span><span class="w">
             </span><span class="err">commission</span><span class="w"> </span><span class="err">price</span><span class="p">,</span><span class="w">
             </span><span class="err">commission</span><span class="w"> </span><span class="err">amount</span><span class="w">
         </span><span class="p">]</span><span class="w">
     </span><span class="p">],</span><span class="w">
     </span><span class="nl">"a"</span><span class="p">:[</span><span class="w"> </span><span class="err">Sell</span><span class="w"> </span><span class="err">order</span><span class="w">
         </span><span class="p">[</span><span class="w">
             </span><span class="err">commission</span><span class="w"> </span><span class="err">price</span><span class="p">,</span><span class="w">
             </span><span class="err">commission</span><span class="w"> </span><span class="err">amount</span><span class="w">
         </span><span class="p">]</span><span class="w">
     </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Get depth data</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/order_book</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>yes</td>
<td>trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.</td>
</tr>
<tr>
<td>level</td>
<td>int32</td>
<td>no</td>
<td>Specifies the maximum level depth to return<br/>Valid values ​​1, 2, 5, 10, 20, 50, 100, 200, 500, 1000<br/>Default value 100</td>
</tr>
<tr>
<td>price_scale</td>
<td>integer</td>
<td>No</td>
<td>Specify the depth of consolidation by price. For example, the price of the specified trading pair has a maximum of 4 decimal places. <br/>price_scale=0, the price returned includes a maximum of 4 decimal places, and <br/>price_scale=1. The price contains up to 3 decimal places, and the order quantity is the sum of all orders in the price range of 0.0010<br/>The price returned when price_scale=2 contains up to 2 decimal places, and the order volume is the sum of all orders in the price range of 0.0100<br/> When price_scale=3, the price returned contains at most 1 decimal place, and the order quantity is the sum of all orders in the price range of 0.1000.<br/> The price returned when price_scale=4 contains at most 0 decimal places, and the order volume is the price range Sum of all orders in 1.0000<br/>Valid values ​​0, 1, 2, 3, 4, 5<br/>Default value 0</td>
</tr>
</tbody></table>

<blockquote>
<p>Note: The data is sorted according to the best price, that is, the depth of the buy side is sorted by price from large to small, and the depth of the sell side is sorted by price from small to large</p>
</blockquote>

<ul>
<li>Data source</li>
</ul>

<p>Cache</p>
<h2 id='get-candles'>Get Candles</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/candles?symbol=4BTC_USDT&amp;time_frame=1m</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/candles?symbol=4BTC_USDT&amp;time_frame=1m'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/candles"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT&amp;time_frame=1m"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">[</span><span class="w">
    </span><span class="err">time</span><span class="p">,</span><span class="w">
    </span><span class="err">open</span><span class="p">,</span><span class="w">
    </span><span class="err">high</span><span class="p">,</span><span class="w">
    </span><span class="err">low</span><span class="p">,</span><span class="w">
    </span><span class="err">close</span><span class="p">,</span><span class="w">
    </span><span class="err">volume</span><span class="p">,</span><span class="w">
    </span><span class="err">amount</span><span class="p">,</span><span class="w">
    </span><span class="err">first</span><span class="w"> </span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">trade</span><span class="w"> </span><span class="err">count</span><span class="p">,</span><span class="w">
  </span><span class="p">]</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get K-line data</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/candles</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>yes</td>
<td>trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.</td>
</tr>
<tr>
<td>time_frame</td>
<td>string</td>
<td>Yes</td>
<td>K-line data time frame<br/>Valid values 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 3d, 1W or 1M</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>No</td>
<td>utc time<br/>limited to return the latest time of the K-line record</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>No</td>
<td>utc time<br/>limited to return the earliest time of the K-line record</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>No</td>
<td>Get the maximum number of K-line records<br/>The default value is 100, and the maximum value is 1000</td>
</tr>
</tbody></table>

<ul>
<li>Parameter combinations and data sources supported by this interface</li>
</ul>

<ol>
<li>symbol + time_frame  --&gt; cache</li>
<li>symbol + time_frame + limit  --&gt; cache</li>
<li>symbol + time_frame + before  --&gt; database</li>
<li>symbol + time_frame + before + limit  --&gt; database</li>
<li>symbol + time_frame + after  --&gt; database</li>
<li>symbol + time_frame + after + limit  --&gt; database</li>
</ol>

<blockquote>
<p>The returned results are sorted by time from earliest to latest</p>
</blockquote>
<h2 id='get-tagprices'>Get TagPrices</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/tagPrices?symbol=4BTC_USDT&amp;time_frame=1m</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/tagPrices?symbol=4BTC_USDT&amp;time_frame=1m'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/tagPrices"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT&amp;time_frame=1m"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">[</span><span class="w">
    </span><span class="err">time</span><span class="p">,</span><span class="w">
    </span><span class="err">open</span><span class="p">,</span><span class="w">
    </span><span class="err">high</span><span class="p">,</span><span class="w">
    </span><span class="err">low</span><span class="p">,</span><span class="w">
    </span><span class="err">close</span><span class="p">,</span><span class="w">
    </span><span class="err">volume</span><span class="p">,</span><span class="w">
    </span><span class="err">amount</span><span class="p">,</span><span class="w">
    </span><span class="err">first</span><span class="w"> </span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">trade</span><span class="w"> </span><span class="err">count</span><span class="p">,</span><span class="w">
  </span><span class="p">]</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get Tag Price Data</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/tagPrices</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>yes</td>
<td>trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.</td>
</tr>
<tr>
<td>time_frame</td>
<td>string</td>
<td>Yes</td>
<td>K-line data time frame<br/>Valid values 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 3d, 1W or 1M</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>No</td>
<td>utc time<br/>limited to return the latest time of the K-line record</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>No</td>
<td>utc time<br/>limited to return the earliest time of the K-line record</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>No</td>
<td>Get the maximum number of K-line records<br/>The default value is 100, and the maximum value is 1000</td>
</tr>
</tbody></table>

<ul>
<li>Parameter combinations and data sources supported by this interface</li>
</ul>

<ol>
<li>symbol + time_frame  --&gt; cache</li>
<li>symbol + time_frame + limit  --&gt; cache</li>
<li>symbol + time_frame + before  --&gt; database</li>
<li>symbol + time_frame + before + limit  --&gt; database</li>
<li>symbol + time_frame + after  --&gt; database</li>
<li>symbol + time_frame + after + limit  --&gt; database</li>
</ol>

<blockquote>
<p>The returned results are sorted by time from earliest to latest</p>
</blockquote>
<h2 id='get-indices'>Get Indices</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/indices?symbol=4BTC_USDT&amp;time_frame=1m</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/indices?symbol=4BTC_USDT&amp;time_frame=1m'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/indices"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT&amp;time_frame=1m"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">[</span><span class="w">
    </span><span class="err">time</span><span class="p">,</span><span class="w">
    </span><span class="err">open</span><span class="p">,</span><span class="w">
    </span><span class="err">high</span><span class="p">,</span><span class="w">
    </span><span class="err">low</span><span class="p">,</span><span class="w">
    </span><span class="err">close</span><span class="p">,</span><span class="w">
    </span><span class="err">volume</span><span class="p">,</span><span class="w">
    </span><span class="err">amount</span><span class="p">,</span><span class="w">
    </span><span class="err">first</span><span class="w"> </span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">trade</span><span class="w"> </span><span class="err">count</span><span class="p">,</span><span class="w">
  </span><span class="p">]</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get index price data</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/indices</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>yes</td>
<td>trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.</td>
</tr>
<tr>
<td>time_frame</td>
<td>string</td>
<td>Yes</td>
<td>K-line data time frame<br/>Valid values 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 3d, 1W or 1M</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>No</td>
<td>utc time<br/>limited to return the latest time of the K-line record</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>No</td>
<td>utc time<br/>limited to return the earliest time of the K-line record</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>No</td>
<td>Get the maximum number of K-line records<br/>The default value is 100, the maximum value is 1000</td>
</tr>
</tbody></table>

<ul>
<li>Parameter combinations and data sources supported by this interface</li>
</ul>

<ol>
<li>symbol + time_frame  --&gt; cache</li>
<li>symbol + time_frame + limit  --&gt; cache</li>
<li>symbol + time_frame + before  --&gt; database</li>
<li>symbol + time_frame + before + limit  --&gt; database</li>
<li>symbol + time_frame + after  --&gt; database</li>
<li>symbol + time_frame + after + limit  --&gt; database</li>
</ol>

<blockquote>
<p>The returned results are sorted by time from earliest to latest</p>
</blockquote>
<h2 id='get-trades'>Get Trades</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/trades?symbol=4BTC_USDT</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/trades?symbol=4BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/trades"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
     </span><span class="nl">"i"</span><span class="p">:</span><span class="s2">"128851"</span><span class="p">,</span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="w">
     </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"30479.2"</span><span class="p">,</span><span class="err">transaction</span><span class="w"> </span><span class="err">price</span><span class="w">
     </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"0.04"</span><span class="p">,</span><span class="err">Volume</span><span class="w">
     </span><span class="nl">"s"</span><span class="p">:</span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">transaction</span><span class="w"> </span><span class="err">direction</span><span class="w">
     </span><span class="nl">"t"</span><span class="p">:</span><span class="s2">"1652434793000"</span><span class="p">,</span><span class="err">trading</span><span class="w"> </span><span class="err">time</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get transaction records</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/trades</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>yes</td>
<td>trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>no</td>
<td>limit the earliest time to return transaction records</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>no</td>
<td>limit the latest time to return transaction records</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>no</td>
<td>transaction id<br/>limited to return the maximum id of transaction records</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>no</td>
<td>transaction id<br/>limited to return the maximum id of transaction records</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>no</td>
<td>get the maximum number of records<br/>default 100, maximum 1000</td>
</tr>
</tbody></table>

<ul>
<li>Parameter combinations and data sources supported by this interface</li>
</ul>

<ol>
<li>symbol  --&gt; cache</li>
<li>symbol + limit  --&gt; cache</li>
<li>symbol + start_time  --&gt; database</li>
<li>symbol + start_time + limit  --&gt; database</li>
<li>symbol + end_time  --&gt; database</li>
<li>symbol + end_time + limit  --&gt; database</li>
<li>symbol + start_time + end_time  --&gt; database</li>
<li>symbol + start_time + end_time + limit  --&gt; database</li>
<li>symbol + before  --&gt; database</li>
<li>symbol + before + limit  --&gt; database</li>
<li>symbol + after  --&gt; database</li>
<li>symbol + after + limit  --&gt; database</li>
</ol>

<p><em>The parameter combination whose data source is cache is used to get the last 1000 transaction records</em></p>

<p><em>The parameter combination whose data source is database is used to obtain earlier transaction records</em></p>

<p><em>If the latest transaction record is obtained with the parameter combination whose data source is database, the result will be slightly delayed than the cache data source</em>
* Usage
  <strong>Usage example: Get all transaction records of a trading pair within three months</strong></p>

<ol>
<li>First use the symbol + limit parameter combination to get the latest transaction record</li>
<li>Use the trade id of the first record obtained as the value of the before parameter, and repeatedly use the symbol + before + limit parameter combination to obtain more records, until all transaction records within three months are obtained and then stop</li>
</ol>

<blockquote>
<p>The returned results are sorted by transaction record id from small to large</p>
</blockquote>
<h2 id='get-tickers'>Get Tickers</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="err">/v4/cbu/marketdata/ticker?symbol=4BTC_USDT</span><span class="s2">`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/marketdata/ticker?symbol=4BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/marketdata/ticker"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
     </span><span class="nl">"s"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">trading</span><span class="w"> </span><span class="err">pair</span><span class="w"> </span><span class="err">name</span><span class="w">
     </span><span class="nl">"o"</span><span class="p">:</span><span class="w"> </span><span class="mf">31366.2</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="err">-hour</span><span class="w"> </span><span class="err">opening</span><span class="w"> </span><span class="err">price</span><span class="w">
     </span><span class="nl">"h"</span><span class="p">:</span><span class="w"> </span><span class="mf">32117.7</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">highest</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="err">hours</span><span class="w">
     </span><span class="nl">"l"</span><span class="p">:</span><span class="w"> </span><span class="mf">32117.7</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">lowest</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="err">hours</span><span class="w">
     </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="mf">27650.5</span><span class="p">,</span><span class="w"> </span><span class="err">latest</span><span class="w"> </span><span class="err">price</span><span class="w">
     </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.075</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">last</span><span class="w"> </span><span class="err">transaction</span><span class="w"> </span><span class="err">quantity</span><span class="w">
     </span><span class="nl">"v"</span><span class="p">:</span><span class="w"> </span><span class="mf">2239.385</span><span class="p">,</span><span class="w"> </span><span class="err">volume</span><span class="w">
     </span><span class="nl">"a"</span><span class="p">:</span><span class="mf">66224658.4286</span><span class="p">,</span><span class="err">Transaction</span><span class="w"> </span><span class="err">value</span><span class="w">
     </span><span class="nl">"c"</span><span class="p">:</span><span class="mf">-0.1184</span><span class="p">,</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">down</span><span class="w">
     </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">57394</span><span class="p">,</span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
     </span><span class="nl">"f"</span><span class="p">:</span><span class="w"> </span><span class="mi">63958</span><span class="p">,</span><span class="w"> </span><span class="err">starting</span><span class="w"> </span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="w">
     </span><span class="nl">"bp"</span><span class="p">:</span><span class="w"> </span><span class="mf">27643.4</span><span class="p">,</span><span class="w"> </span><span class="err">buy</span><span class="w"> </span><span class="err">one</span><span class="w"> </span><span class="err">price</span><span class="w">
     </span><span class="nl">"bq"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.089</span><span class="p">,</span><span class="w"> </span><span class="err">buy</span><span class="w"> </span><span class="err">one</span><span class="w"> </span><span class="err">quantity</span><span class="w">
     </span><span class="nl">"ap"</span><span class="p">:</span><span class="w"> </span><span class="mf">27645.5</span><span class="p">,</span><span class="w"> </span><span class="err">sell</span><span class="w"> </span><span class="err">one</span><span class="w"> </span><span class="err">price</span><span class="w">
     </span><span class="nl">"aq"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="err">sell</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">quantity</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get Ticker Data</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/marketdata/ticker</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>Yes</td>
<td>Trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.<br/>Multiple trading pair codes can be specified as follows<br/> /pairs?symbol=4BTC_USDT,4ETH_USDT</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>Cache</p>
<h1 id='market-data-streams'>Market Data Streams</h1><h2 id='overview'>Overview</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://market-wss.bibox360.com/cbu</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
            <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="dl">"</span><span class="s2">4BTC_USDT.order_book.1</span><span class="dl">"</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">}));</span>
        <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">ws</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
        <span class="p">},</span><span class="mi">30000</span><span class="p">)</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">rece message</span><span class="dl">"</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">websocket</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://market-wss.bibox360.com/cbu'</span>

<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"id"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
        <span class="s">"method"</span><span class="p">:</span> <span class="s">"SUBSCRIBE"</span><span class="p">,</span>
        <span class="s">"params"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">"4BTC_USDT.order_book.1"</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="c1"># websocket.enableTrace(True)
</span>    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Linq</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://market-wss.bibox360.com/cbu"</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">jarray</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JArray</span><span class="p">();</span>
            <span class="n">jarray</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"4BTC_USDT.order_book.1"</span><span class="p">);</span>
            <span class="n">JObject</span> <span class="n">val</span> <span class="p">=</span> <span class="k">new</span> <span class="n">JObject</span> <span class="p">{</span>
                <span class="p">{</span><span class="s">"id"</span><span class="p">,</span> <span class="m">123</span> <span class="p">},</span>
                <span class="p">{</span><span class="s">"method"</span><span class="p">,</span> <span class="s">"SUBSCRIBE"</span> <span class="p">},</span>
                <span class="p">{</span><span class="s">"params"</span><span class="p">,</span> <span class="n">jarray</span> <span class="p">}</span>
            <span class="p">};</span>
            <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>

            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span> <span class="p">(</span><span class="n">wsuri</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"recv: "</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>

            <span class="p">};</span>

            <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span> <span class="p">();</span>

            <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span> <span class="p">(</span><span class="n">payload</span><span class="p">);</span>

            <span class="n">ConsoleKey</span> <span class="n">key</span><span class="p">;</span>
            <span class="k">do</span>
            <span class="p">{</span>
                  <span class="n">key</span><span class="p">=</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">().</span><span class="n">Key</span><span class="p">;</span>

            <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Q</span><span class="p">);</span>

            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<p>*<em>Using Websocket push service can get market information in time. *</em></p>

<ul>
<li>Connect to Websocket server
Please use the following URL to connect to the Websocket server:
<br/>
wss://market-wss.bibox360.com/cbu</li>
</ul>

<blockquote>
<p>After connecting, the client can send the following JSON-formatted request to the server</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">given</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">client</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">type</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">parameter</span><span class="w"> </span><span class="err">list</span><span class="w">
    </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>After receiving the request, the server will send the following response in JSON format to the client</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">result</span><span class="p">,</span><span class="w"> </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w"> </span><span class="err">also</span><span class="w"> </span><span class="err">means</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subscription</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">successful</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>If an error occurs, the server will send the following error message to the client</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">id</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1000</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">error</span><span class="w"> </span><span class="err">code</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">error</span><span class="w"> </span><span class="err">description</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>At the same time, the server will also send the following data stream in JSON format to the client, the data stream contains the change information of the market</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4BTC_USDT.trades"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">name</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">data</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>request: subscribe to data stream</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"stream name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"stream name"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>After connecting, please send the request to the server first, and then the server will send the corresponding data stream to the client when the market price changes.</p>

<p>&quot;data stream name&quot; is the data stream name, which is a string in the following format.
symbol.data_type.param1.param2...</p>

<p>Among them, symbol is the name of the trading pair, such as 4BTC_USDT, 4ETH_USDT, etc.
data_type is the data type, currently only the following data types are supported
order_book: depth
trades: list of trades
candles: candlesticks
ticker: latest transaction information
indices: index price K line
tagPrices: mark the price K line</p>

<p>After data_type is the parameter list, different data types have different parameter lists, which will be introduced later</p>

<p>request: unsubscribe stream</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNSUBSCRIBE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"data stream name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data stream name"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>If the request is handled correctly by the server, the client will receive the following response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>If the request fails, the client will receive the following error response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1000</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">error</span><span class="w"> </span><span class="err">code</span><span class="w">
   </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">error</span><span class="w"> </span><span class="err">description</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='request-methods'>Request Methods</h2>
<blockquote>
<p>Request type and parameters</p>

<p>The client can send the following request to the server</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">given</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">client</span><span class="w">
   </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">type</span><span class="w">
   </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">request</span><span class="w"> </span><span class="err">parameter</span><span class="w"> </span><span class="err">list</span><span class="w">
    </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>where the value of the method field is one of the following request types:</li>
</ul>

<table><thead>
<tr>
<th>optional value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SUBSCRIBE</td>
<td>1. Subscribe to the data stream<br/> 2. The parameter is a list of data stream names <br/> 3. After successful subscription, the server will send the data stream to the client when the market price changes</td>
</tr>
<tr>
<td>UNSUBSCRIBE</td>
<td>1. Unsubscribe data stream<br/> 2. The parameter is a list of data stream names <br/> 3. After successfully unsubscribing, the client will no longer receive the corresponding data stream</td>
</tr>
</tbody></table>
<h2 id='subscribe-order-book'>Subscribe Order Book</h2>
<p><strong>Subscribe in-depth information</strong></p>

<blockquote>
<p>Send the following request to subscribe to in-depth information</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"4BTC_USDT.order_book.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"4ETH_USDT.order_book.1"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>parameter</li>
</ul>

<ol>
<li>The parameter of the request is the depth stream name, in the following format:</li>
</ol>

<ul>
<li>&lt;symbol&gt;.order_book.&lt;max depth&gt;

<ol>
<li>&lt;symbol&gt; is the name of the trading pair, such as 4BTC_USDT, 4ETH_USDT, etc.</li>
<li> &lt;max depth&gt; is the maximum depth, valid values are 1, 2, 5, 10, 20, 50, 100, 200, 500, 1000</li>
</ol></li>
</ul>

<blockquote>
<p>Data flow</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">
</span><span class="err">//</span><span class="w"> </span><span class="err">If</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subscription</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">successful,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">//</span><span class="w"> </span><span class="err">After</span><span class="w"> </span><span class="err">that,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
     </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"4APE_USDT.order_book.1"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"i"</span><span class="p">:</span><span class="s2">"13890055"</span><span class="p">,</span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
         </span><span class="nl">"t"</span><span class="p">:</span><span class="s2">"1654826751000"</span><span class="p">,</span><span class="err">time</span><span class="w">
         </span><span class="nl">"b"</span><span class="p">:[</span><span class="w"> </span><span class="err">buy</span><span class="w"> </span><span class="err">order</span><span class="w">
             </span><span class="p">[</span><span class="w">
                 </span><span class="err">price</span><span class="p">,</span><span class="w">
                 </span><span class="err">quantity</span><span class="w">
             </span><span class="p">],</span><span class="w">
             </span><span class="p">[</span><span class="w">
                 </span><span class="s2">"5.645"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"103"</span><span class="w">
             </span><span class="p">]</span><span class="w">
         </span><span class="p">],</span><span class="w">
         </span><span class="nl">"a"</span><span class="p">:[</span><span class="w"> </span><span class="err">Sell</span><span class="w"> </span><span class="err">order</span><span class="w">
             </span><span class="p">[</span><span class="w">
                 </span><span class="s2">"5.646"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"902"</span><span class="w">
             </span><span class="p">],</span><span class="w">
             </span><span class="p">[</span><span class="w">
                 </span><span class="s2">"5.647"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"0"</span><span class="w">
             </span><span class="p">]</span><span class="w">
         </span><span class="p">]</span><span class="w">
     </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>After successful subscription, the client will first receive a full depth data stream, and then will receive an incremental change data stream, please use the following method to synthesize the full depth.
The number is 0, which means that the depth is deleted.
If the price is the same, the quantity will be replaced directly.</p>
</blockquote>
<h2 id='subscribe-trades'>Subscribe Trades</h2>
<p><strong>Subscribe to Trades List</strong></p>

<blockquote>
<p>Send the following request to subscribe to the transaction list</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"4BTC_USDT.trades"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"4ETH_USDT.trades"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>parameter</li>
</ul>

<ol>
<li>The parameter of the request is the name of the transaction flow, in the following format:</li>
</ol>

<ul>
<li>&lt;symbol&gt;.trades

<ol>
<li>&lt;symbol&gt; is the name of the trading pair, such as 4BTC_USDT, 4ETH_USDT, etc.</li>
</ol></li>
</ul>

<blockquote>
<p>Data flow</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="err">//</span><span class="w"> </span><span class="err">If</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subscription</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">successful,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">//</span><span class="w"> </span><span class="err">After</span><span class="w"> </span><span class="err">that,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
     </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"4BTC_USDT.trades"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"data"</span><span class="p">:[</span><span class="w">
         </span><span class="p">{</span><span class="w">
             </span><span class="nl">"i"</span><span class="p">:</span><span class="s2">"128851"</span><span class="p">,</span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="w">
             </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"30479.2"</span><span class="p">,</span><span class="err">transaction</span><span class="w"> </span><span class="err">price</span><span class="w">
             </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"0.04"</span><span class="p">,</span><span class="err">Volume</span><span class="w">
             </span><span class="nl">"s"</span><span class="p">:</span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">transaction</span><span class="w"> </span><span class="err">direction</span><span class="w">
             </span><span class="nl">"t"</span><span class="p">:</span><span class="s2">"1652434793000"</span><span class="p">,</span><span class="err">trading</span><span class="w"> </span><span class="err">time</span><span class="w">
         </span><span class="p">}</span><span class="w">
     </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='subscribe-candles'>Subscribe Candles</h2>
<p><strong>Subscribe to K line</strong></p>

<blockquote>
<p>Send the following request to subscribe to K-line</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"4BTC_USDT.candles.1m"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"4ETH_USDT.candles.1h"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>parameter</li>
</ul>

<ol>
<li>The K-line flow name format is as follows:</li>
</ol>

<ul>
<li>&lt;symbol&gt;.candles.&lt;time_frame&gt;

<ol>
<li>&lt;symbol&gt; is the name of the trading pair, such as 4BTC_USDT, 4ETH_USDT, etc.</li>
<li>&lt;time_frame&gt; is the K-line period, the valid values are 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 1w, 1M</li>
</ol></li>
</ul>

<blockquote>
<p>Data flow</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="err">//</span><span class="w"> </span><span class="err">If</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subscription</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">successful,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">//</span><span class="w"> </span><span class="err">After</span><span class="w"> </span><span class="err">that,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"4BTC_USDT.candles.1m"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">category</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">60000</span><span class="p">,</span><span class="w">
        </span><span class="nl">"e"</span><span class="p">:[</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="err">time</span><span class="p">,</span><span class="w">
                </span><span class="err">open</span><span class="p">,</span><span class="w">
                </span><span class="err">high</span><span class="p">,</span><span class="w">
                </span><span class="err">low</span><span class="p">,</span><span class="w">
                </span><span class="err">close</span><span class="p">,</span><span class="w">
                </span><span class="err">volume</span><span class="p">,</span><span class="w">
                </span><span class="err">amount</span><span class="p">,</span><span class="w">
                </span><span class="err">first</span><span class="w"> </span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
                </span><span class="err">trade</span><span class="w"> </span><span class="err">count</span><span class="p">,</span><span class="w">
            </span><span class="p">]</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='subscribe-tickers'>Subscribe Tickers</h2>
<p><strong>Subscribe to Tickers</strong></p>

<blockquote>
<p>Send the following request to subscribe to Ticker</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"4BTC_USDT.ticker"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"4ETH_USDT.ticker"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>parameter</li>
</ul>

<ol>
<li>The format of the Ticker stream name is as follows:</li>
</ol>

<ul>
<li>&lt;symbol&gt;.ticker

<ol>
<li>&lt;symbol&gt; is the name of the trading pair, such as 4BTC_USDT, 4ETH_USDT, etc.</li>
</ol></li>
</ul>

<blockquote>
<p>Data flow</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="err">//</span><span class="w"> </span><span class="err">If</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subscription</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">successful,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">//</span><span class="w"> </span><span class="err">After</span><span class="w"> </span><span class="err">that,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
     </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"4BTC_USDT.ticker"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"s"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">trading</span><span class="w"> </span><span class="err">pair</span><span class="w"> </span><span class="err">name</span><span class="w">
         </span><span class="nl">"o"</span><span class="p">:</span><span class="w"> </span><span class="mf">31366.2</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="err">-hour</span><span class="w"> </span><span class="err">opening</span><span class="w"> </span><span class="err">price</span><span class="w">
         </span><span class="nl">"h"</span><span class="p">:</span><span class="w"> </span><span class="mf">32117.7</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">highest</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="err">hours</span><span class="w">
         </span><span class="nl">"l"</span><span class="p">:</span><span class="w"> </span><span class="mf">32117.7</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">lowest</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="err">hours</span><span class="w">
         </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="mf">27650.5</span><span class="p">,</span><span class="w"> </span><span class="err">latest</span><span class="w"> </span><span class="err">price</span><span class="w">
         </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.075</span><span class="p">,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">last</span><span class="w"> </span><span class="err">transaction</span><span class="w"> </span><span class="err">quantity</span><span class="w">
         </span><span class="nl">"v"</span><span class="p">:</span><span class="w"> </span><span class="mf">2239.385</span><span class="p">,</span><span class="w"> </span><span class="err">volume</span><span class="w">
         </span><span class="nl">"a"</span><span class="p">:</span><span class="mf">66224658.4286</span><span class="p">,</span><span class="err">Transaction</span><span class="w"> </span><span class="err">value</span><span class="w">
         </span><span class="nl">"c"</span><span class="p">:</span><span class="mf">-0.1184</span><span class="p">,</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">down</span><span class="w">
         </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">57394</span><span class="p">,</span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
         </span><span class="nl">"f"</span><span class="p">:</span><span class="w"> </span><span class="mi">63958</span><span class="p">,</span><span class="w"> </span><span class="err">starting</span><span class="w"> </span><span class="err">trade</span><span class="w"> </span><span class="err">id</span><span class="w">
         </span><span class="nl">"bp"</span><span class="p">:</span><span class="w"> </span><span class="mf">27643.4</span><span class="p">,</span><span class="w"> </span><span class="err">buy</span><span class="w"> </span><span class="err">one</span><span class="w"> </span><span class="err">price</span><span class="w">
         </span><span class="nl">"bq"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.089</span><span class="p">,</span><span class="w"> </span><span class="err">buy</span><span class="w"> </span><span class="err">one</span><span class="w"> </span><span class="err">quantity</span><span class="w">
         </span><span class="nl">"ap"</span><span class="p">:</span><span class="w"> </span><span class="mf">27645.5</span><span class="p">,</span><span class="w"> </span><span class="err">sell</span><span class="w"> </span><span class="err">one</span><span class="w"> </span><span class="err">price</span><span class="w">
         </span><span class="nl">"aq"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="err">sell</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">quantity</span><span class="w">
     </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='subscribe-indices'>Subscribe Indices</h2>
<p><strong>Subscribe to index K line</strong></p>

<blockquote>
<p>Send the following request to subscribe to the index K line</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"4BTC_USDT.indices.1m"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"4ETH_USDT.indices.1h"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>parameter</li>
</ul>

<ol>
<li>The format of the index K-line stream name is as follows:</li>
</ol>

<ul>
<li>&lt;symbol&gt;.indices.&lt;time_frame&gt;

<ol>
<li>&lt;symbol&gt; is the name of the trading pair, such as 4BTC_USDT, 4ETH_USDT, etc.</li>
<li>&lt;time_frame&gt; is the K-line period, the valid values are 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 1w, 1M</li>
</ol></li>
</ul>

<blockquote>
<p>Data flow</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="err">//</span><span class="w"> </span><span class="err">If</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subscription</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">successful,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">//</span><span class="w"> </span><span class="err">After</span><span class="w"> </span><span class="err">that,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"4BTC_USDT.indices.1m"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">category</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">60000</span><span class="p">,</span><span class="w">
        </span><span class="nl">"e"</span><span class="p">:[</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="err">time</span><span class="p">,</span><span class="w">
                </span><span class="err">open(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">high(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">low(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">close</span><span class="p">,</span><span class="w">
                </span><span class="err">volume(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">amount(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">firstTradeId(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">tradeCount(ignore)</span><span class="p">,</span><span class="w">
            </span><span class="p">]</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='subscribe-tag-prices'>Subscribe Tag Prices</h2>
<p><strong>Subscribe to tag price K line</strong></p>

<blockquote>
<p>Send the following request to subscribe to the tag price candlestick</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"4BTC_USDT.tagPrices.1m"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"4ETH_USDT.tagPrices.1h"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<ul>
<li>parameter</li>
</ul>

<ol>
<li>The name format of the mark price K-line stream is as follows:</li>
</ol>

<ul>
<li>&lt;symbol&gt;.tagPrices.&lt;time_frame&gt;

<ol>
<li>&lt;symbol&gt; is the name of the trading pair, such as 4BTC_USDT, 4ETH_USDT, etc.</li>
<li>&lt;time_frame&gt; is the K-line period, the valid values are 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 1w, 1M</li>
</ol></li>
</ul>

<blockquote>
<p>Data flow</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="err">//</span><span class="w"> </span><span class="err">If</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">subscription</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">successful,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">//</span><span class="w"> </span><span class="err">After</span><span class="w"> </span><span class="err">that,</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">stream</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">returned</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"4BTC_USDT.tagPrices.1m"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">category</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">60000</span><span class="p">,</span><span class="w">
        </span><span class="nl">"e"</span><span class="p">:[</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="err">time</span><span class="p">,</span><span class="w">
                </span><span class="err">open(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">high(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">low(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">close</span><span class="p">,</span><span class="w">
                </span><span class="err">volume(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">amount(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">firstTradeId(ignore)</span><span class="p">,</span><span class="w">
                </span><span class="err">tradeCount(ignore)</span><span class="p">,</span><span class="w">
            </span><span class="p">]</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<hr>
<h1 id='user-data-endpoints'>User Data Endpoints</h1><h2 id='get-accounts'>Get Accounts</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/accounts?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span> <span class="c1">// optional</span>
          <span class="p">},</span>
        <span class="p">},</span>

        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/accounts'</span>

    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=USDT'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/accounts"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"asset=USDT"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="err">c:</span><span class="w"> </span><span class="err">'USDT'</span><span class="p">,</span><span class="w"> </span><span class="err">currency</span><span class="w"> </span><span class="err">symbol</span><span class="w">
     </span><span class="err">b:</span><span class="w"> </span><span class="err">'</span><span class="mf">8247.1187293513</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">account</span><span class="w"> </span><span class="err">available</span><span class="w"> </span><span class="err">balance</span><span class="w">
     </span><span class="err">ff:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">isolated</span><span class="w"> </span><span class="err">pending</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">freeze</span><span class="w">
     </span><span class="err">fc:</span><span class="w"> </span><span class="err">'</span><span class="mf">346.73844114</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">all</span><span class="w"> </span><span class="err">pending</span><span class="w"> </span><span class="err">orders</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">frozen</span><span class="w">
     </span><span class="err">mf:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">isolated</span><span class="w"> </span><span class="err">margin</span><span class="w">
     </span><span class="err">mc:</span><span class="w"> </span><span class="err">'</span><span class="mf">1396.55822362</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">full</span><span class="w"> </span><span class="err">margin</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get the balance, freezing and other information of various assets in the account corresponding to the API Key</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/accounts</li>
<li>Permissions: View, Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>asset</td>
<td>string</td>
<td>No</td>
<td>Asset code, such as USDT, etc.<br/>Multiple asset codes can be specified in the following form<br/> /v4/cbu/userdata/accounts?asset=BTC,ETH<br/> If no asset is specified parameter, returns the information of all assets</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>Cache</p>
<h2 id='get-an-account-39-s-ledger'>Get an account&#39;s ledger</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=USDT&amp;end_time=1651895799668&amp;limit=10</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/ledger?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/ledger'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=USDT&amp;end_time=1651895799668&amp;limit=10'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/ledger"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"asset=USDT&amp;end_time=1651895799668&amp;limit=10"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="err">i:</span><span class="w"> </span><span class="err">ledger</span><span class="w"> </span><span class="err">id</span><span class="w">
     </span><span class="err">s:</span><span class="w"> </span><span class="err">currency</span><span class="w"> </span><span class="err">symbol</span><span class="w">
     </span><span class="err">p:</span><span class="w"> </span><span class="err">trading</span><span class="w"> </span><span class="err">pair</span><span class="w">
     </span><span class="err">T:</span><span class="w"> </span><span class="err">Bill</span><span class="w"> </span><span class="err">Type</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">Transfer</span><span class="p">,</span><span class="mi">2</span><span class="w"> </span><span class="err">Trade</span><span class="p">,</span><span class="mi">3</span><span class="w"> </span><span class="err">Fee</span><span class="p">,</span><span class="mi">4</span><span class="w"> </span><span class="err">Fund</span><span class="w"> </span><span class="err">fee</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">Adjust</span><span class="w"> </span><span class="err">fund</span><span class="w"> </span><span class="err">fee</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">Force</span><span class="w"> </span><span class="err">sub</span><span class="w"> </span><span class="err">hold</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="err">Force</span><span class="w"> </span><span class="err">clear</span><span class="w"> </span><span class="err">hold</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="err">ADL</span><span class="w">
     </span><span class="err">a:</span><span class="w"> </span><span class="err">change</span><span class="w"> </span><span class="err">amount</span><span class="w">
     </span><span class="err">b:</span><span class="w"> </span><span class="err">balance</span><span class="w">
     </span><span class="err">t:</span><span class="w"> </span><span class="err">time</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get the bill of the account corresponding to the API Key, including all records of changing the account balance, such as fund transfer, transaction, fee collection, etc.</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/ledger</li>
<li>Permissions: View, Trade</li>
<li>request parameters (should be sorted)</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>asset</td>
<td>string</td>
<td>No</td>
<td>Asset code, such as USDT, etc.<br/>Multiple asset codes can be specified in the following form<br/> /v4/cbu/userdata/ledger?asset=BTC,ETH <br/> If no asset is specified parameter, then return the billing records of all assets</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>No</td>
<td>Limit the earliest time to return bill records</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>no</td>
<td>limit the latest time to return bill records</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>No</td>
<td>Billing record id<br/>Limited to return the maximum id value of the billing record</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>No</td>
<td>Billing record id<br/>Limited to return the minimum id value of the billing record</td>
</tr>
<tr>
<td>limit</td>
<td>int32</td>
<td>No</td>
<td>Limit the maximum number of returned billing records<br/>default 100</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>No</td>
<td>Limit the earliest time to return bill records</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>No</td>
<td>Limit the earliest time to return bill records</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>DB</p>
<h2 id='create-an-order'>Create an order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">symbol</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">order_side</span><span class="dl">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">order_type</span><span class="dl">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">amount</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">0.001</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">price</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">20000</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/order</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span><span class="p">,</span>
        <span class="s">'order_side'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'order_type'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="s">'0.001'</span><span class="p">,</span>
        <span class="s">'price'</span><span class="p">:</span> <span class="s">'20000'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/order'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/order"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">order_side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">order_type</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                 <span class="n">price</span> <span class="p">=</span> <span class="s">"20000"</span><span class="p">,</span>
                 <span class="n">amount</span> <span class="p">=</span> <span class="s">"0.001"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="err">i:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">I:</span><span class="w"> </span><span class="err">client</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">m:</span><span class="w"> </span><span class="err">pair</span><span class="w">
   </span><span class="err">T:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price，</span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price)</span><span class="w">
   </span><span class="err">s:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">side</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">long，</span><span class="mi">2</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">short，</span><span class="mi">3</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">long，</span><span class="mi">4</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">short)</span><span class="w">
   </span><span class="err">Q:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
   </span><span class="err">P:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
   </span><span class="err">S:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">status</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">pending，</span><span class="mi">2</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">part，</span><span class="mi">3</span><span class="w"> </span><span class="err">filled，</span><span class="mi">4</span><span class="w"> </span><span class="err">cancelled</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">part，</span><span class="mi">5</span><span class="w"> </span><span class="err">canceled，</span><span class="mi">100</span><span class="w"> </span><span class="err">fail)</span><span class="w">
   </span><span class="err">r:</span><span class="w"> </span><span class="err">failure</span><span class="w"> </span><span class="err">reason</span><span class="w">
   </span><span class="err">M:</span><span class="w"> </span><span class="err">failure</span><span class="w"> </span><span class="err">description</span><span class="w">
   </span><span class="err">E:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
   </span><span class="err">e:</span><span class="w"> </span><span class="err">Average</span><span class="w"> </span><span class="err">transaction</span><span class="w"> </span><span class="err">price</span><span class="w">
   </span><span class="err">C:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">Creation</span><span class="w"> </span><span class="err">Time</span><span class="w">
   </span><span class="err">U:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
   </span><span class="err">V:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">z:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">Freeze</span><span class="w"> </span><span class="err">Assets</span><span class="w">
   </span><span class="err">rm:</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
   </span><span class="err">rt:</span><span class="w"> </span><span class="err">taker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
   </span><span class="err">of:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">source</span><span class="w">
   </span><span class="err">pid:</span><span class="w"> </span><span class="err">corresponding</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">ot:</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">that</span><span class="w"> </span><span class="err">contains</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">take</span><span class="w"> </span><span class="err">profit</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">loss</span><span class="w"> </span><span class="err">order</span><span class="w">
   </span><span class="err">f:</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
   </span><span class="err">fb:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="w">
   </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="err">deduct</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
   </span><span class="err">n:</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
   </span><span class="err">F:</span><span class="w"> </span><span class="p">[</span><span class="err">//</span><span class="w"> </span><span class="err">Transaction</span><span class="w"> </span><span class="err">details</span><span class="p">,</span><span class="w"> </span><span class="err">only</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">latest</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="err">items</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">displayed</span><span class="w">
     </span><span class="p">{</span><span class="w">
       </span><span class="err">i:</span><span class="w"> </span><span class="err">fill</span><span class="w"> </span><span class="err">id</span><span class="w">
       </span><span class="err">t:</span><span class="w"> </span><span class="err">time</span><span class="w">
       </span><span class="err">p:</span><span class="w"> </span><span class="err">price</span><span class="w">
       </span><span class="err">q:</span><span class="w"> </span><span class="err">quantity</span><span class="w">
       </span><span class="err">l:</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">taker</span><span class="w">
       </span><span class="err">f:</span><span class="w"> </span><span class="err">fee</span><span class="w">
       </span><span class="err">fb:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
       </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">discount</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Place order</strong></p>

<ul>
<li>Request method POST</li>
<li>Request path /v4/cbu/userdata/order</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>yes</td>
<td>trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.</td>
</tr>
<tr>
<td>order_side</td>
<td>string</td>
<td>Yes</td>
<td>Order direction, valid values ​​are 1 to open long, 2 to open short, 3 to close long, 4 to close short</td>
</tr>
<tr>
<td>order_type</td>
<td>string</td>
<td>yes</td>
<td>order type, valid values ​​1 market order, 2 limit order</td>
</tr>
<tr>
<td>client_oid</td>
<td>string</td>
<td>No</td>
<td>Order id, a string with a valid value of int64 integer, it is recommended to use the Unix timestamp when submitting the order</td>
</tr>
<tr>
<td>amount</td>
<td>decimal</td>
<td>No</td>
<td>Delegated amount</td>
</tr>
<tr>
<td>price</td>
<td>decimal</td>
<td>No</td>
<td>Order Limit</td>
</tr>
</tbody></table>

<blockquote>
<p>Delegate object
Up to 20 deals including the order
If the order has more than 20 transactions, the object only contains the last 20 transactions, and other transactions can be obtained through the fills interface</p>
</blockquote>
<h2 id='get-an-order'>Get an order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">order_id=1118621391231</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/order?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/order'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'order_id=14118828812271651'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/order"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"order_id=14118828812271651"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="err">i:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">I:</span><span class="w"> </span><span class="err">client</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">m:</span><span class="w"> </span><span class="err">pair</span><span class="w">
   </span><span class="err">T:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price，</span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price)</span><span class="w">
   </span><span class="err">s:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">side</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">long，</span><span class="mi">2</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">short，</span><span class="mi">3</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">long，</span><span class="mi">4</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">short)</span><span class="w">
   </span><span class="err">Q:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
   </span><span class="err">P:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
   </span><span class="err">S:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">status</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">pending，</span><span class="mi">2</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">part，</span><span class="mi">3</span><span class="w"> </span><span class="err">filled，</span><span class="mi">4</span><span class="w"> </span><span class="err">cancelled</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">part，</span><span class="mi">5</span><span class="w"> </span><span class="err">canceled，</span><span class="mi">100</span><span class="w"> </span><span class="err">fail)</span><span class="w">
   </span><span class="err">r:</span><span class="w"> </span><span class="err">failure</span><span class="w"> </span><span class="err">reason</span><span class="w">
   </span><span class="err">M:</span><span class="w"> </span><span class="err">failure</span><span class="w"> </span><span class="err">description</span><span class="w">
   </span><span class="err">E:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
   </span><span class="err">e:</span><span class="w"> </span><span class="err">Average</span><span class="w"> </span><span class="err">transaction</span><span class="w"> </span><span class="err">price</span><span class="w">
   </span><span class="err">C:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">Creation</span><span class="w"> </span><span class="err">Time</span><span class="w">
   </span><span class="err">U:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
   </span><span class="err">V:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">z:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">Freeze</span><span class="w"> </span><span class="err">Assets</span><span class="w">
   </span><span class="err">rm:</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
   </span><span class="err">rt:</span><span class="w"> </span><span class="err">taker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
   </span><span class="err">of:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">source</span><span class="w">
   </span><span class="err">pid:</span><span class="w"> </span><span class="err">corresponding</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">id</span><span class="w">
   </span><span class="err">ot:</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">that</span><span class="w"> </span><span class="err">contains</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">take</span><span class="w"> </span><span class="err">profit</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">loss</span><span class="w"> </span><span class="err">order</span><span class="w">
   </span><span class="err">f:</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
   </span><span class="err">fb:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="w">
   </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="err">deduct</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
   </span><span class="err">n:</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Get the delegate with the specified id</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/order</li>
<li>Permissions: View, Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>string</td>
<td>Yes</td>
<td>Order id<br/>Order id can be assigned by the exchange, <br/>Can also be user-defined (use the client_order_id parameter when submitting the order).<br/>When using self When defining an id, you need to add a &quot;c:&quot; prefix before the id.<br/>For example: when submitting a delegation, a custom id &quot;123&quot; is used, and when obtaining a delegation, you need to use &quot;c:123&quot;.</td>
</tr>
</tbody></table>
<h2 id='get-orders'>Get Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;status=settled&amp;symbol=4BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/orders?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/orders'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;status=settled&amp;symbol=4BTC_USDT'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/orders"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"limit=2&amp;status=settled&amp;symbol=4BTC_USDT"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">[</span>
  <span class="p">{</span>
     <span class="na">i</span><span class="p">:</span> <span class="nx">order</span> <span class="nx">id</span>
     <span class="na">I</span><span class="p">:</span> <span class="nx">client</span> <span class="nx">order</span> <span class="nx">id</span>
     <span class="na">m</span><span class="p">:</span> <span class="nx">pair</span>
     <span class="na">T</span><span class="p">:</span> <span class="nx">order</span> <span class="nx">type</span> <span class="p">(</span><span class="mi">1</span> <span class="nx">market</span> <span class="nx">price</span><span class="err">，</span><span class="mi">2</span> <span class="nx">limit</span> <span class="nx">price</span><span class="p">)</span>
     <span class="na">s</span><span class="p">:</span> <span class="nx">order</span> <span class="nx">side</span> <span class="p">(</span><span class="mi">1</span> <span class="nx">open</span> <span class="nx">long</span><span class="err">，</span><span class="mi">2</span> <span class="nx">open</span> <span class="nx">short</span><span class="err">，</span><span class="mi">3</span> <span class="nx">close</span> <span class="nx">long</span><span class="err">，</span><span class="mi">4</span> <span class="nx">close</span> <span class="nx">short</span><span class="p">)</span>
     <span class="na">Q</span><span class="p">:</span> <span class="nx">Order</span> <span class="nx">quantity</span>
     <span class="na">P</span><span class="p">:</span> <span class="nx">order</span> <span class="nx">price</span>
     <span class="na">S</span><span class="p">:</span> <span class="nx">order</span> <span class="nx">status</span> <span class="p">(</span><span class="mi">1</span> <span class="nx">pending</span><span class="err">，</span><span class="mi">2</span> <span class="nx">deal</span> <span class="nx">part</span><span class="err">，</span><span class="mi">3</span> <span class="nx">filled</span><span class="err">，</span><span class="mi">4</span> <span class="nx">cancelled</span> <span class="kd">with</span> <span class="nx">deal</span> <span class="nx">part</span><span class="err">，</span><span class="mi">5</span> <span class="nx">canceled</span><span class="err">，</span><span class="mi">100</span> <span class="nx">fail</span><span class="p">)</span>
     <span class="na">r</span><span class="p">:</span> <span class="nx">failure</span> <span class="nx">reason</span>
     <span class="na">M</span><span class="p">:</span> <span class="nx">failure</span> <span class="nx">description</span>
     <span class="na">E</span><span class="p">:</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">transactions</span>
     <span class="na">e</span><span class="p">:</span> <span class="nx">Average</span> <span class="nx">transaction</span> <span class="nx">price</span>
     <span class="na">C</span><span class="p">:</span> <span class="nx">Order</span> <span class="nx">Creation</span> <span class="nx">Time</span>
     <span class="na">U</span><span class="p">:</span> <span class="nx">order</span> <span class="nx">update</span> <span class="nx">time</span>
     <span class="na">V</span><span class="p">:</span> <span class="nx">update</span> <span class="nx">id</span>
     <span class="na">z</span><span class="p">:</span> <span class="nx">Order</span> <span class="nx">Freeze</span> <span class="nx">Assets</span>
     <span class="na">rm</span><span class="p">:</span> <span class="nx">maker</span> <span class="nx">fee</span> <span class="nx">rate</span>
     <span class="na">rt</span><span class="p">:</span> <span class="nx">taker</span> <span class="nx">fee</span> <span class="nx">rate</span>
     <span class="na">of</span><span class="p">:</span> <span class="nx">order</span> <span class="nx">source</span>
     <span class="na">pid</span><span class="p">:</span> <span class="nx">corresponding</span> <span class="nx">position</span> <span class="nx">id</span>
     <span class="na">ot</span><span class="p">:</span> <span class="nx">the</span> <span class="nx">order</span> <span class="nx">type</span> <span class="nx">that</span> <span class="nx">contains</span> <span class="nx">the</span> <span class="nx">take</span> <span class="nx">profit</span> <span class="nx">and</span> <span class="nx">stop</span> <span class="nx">loss</span> <span class="nx">order</span>
     <span class="na">f</span><span class="p">:</span> <span class="nx">handling</span> <span class="nx">fee</span>
     <span class="na">fb</span><span class="p">:</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">,</span>
     <span class="na">fb0</span><span class="p">:</span> <span class="nx">deduct</span> <span class="nx">handling</span> <span class="nx">fee</span>
     <span class="na">n</span><span class="p">:</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">transactions</span>
 <span class="p">}</span>
  <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>
<p><strong>Obtain the delegation that meets the following conditions in the account corresponding to ApiKey</strong></p>

<ol>
<li>All unsettled orders</li>
<li>Settled orders within three months, including rejected, cancelled and filled orders</li>
<li>All completed orders</li>
<li>All partially cancelled orders</li>
</ol>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/orders</li>
<li>Permissions: View, Trade</li>
<li>request parameters (should be sorted)</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td>string</td>
<td>No</td>
<td>Order id<br>The order id can be assigned by the exchange,<br/>or user-defined (use the client_order_id parameter when submitting the order). <br>When using a custom id, you need to add a &quot;c:&quot; prefix before the id. <br/>For example: the custom id &quot;123&quot; is used when submitting the order, and &quot;c:123&quot; must be used when canceling the order. <br/>Multiple delegate ids can be specified in the following form<br/> &quot;123,124,125,c:200&quot;</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>No</td>
<td>Valid values ​​unsettled, settled<br/>unsettled means get unsettled orders, the returned results are sorted in reverse order by order creation time<br/>settled means settled orders are acquired, and the returned results are sorted in reverse order by order settlement time <br/>Default unsettled</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>No</td>
<td>Trading pair code, such as 4BTC_USDT, 4ETH_USDT, etc.<br/>Multiple trading pair codes can be specified in the following form<br/> /v4/cbu/userdata/orders?symbol=4BTC_USDT,4ETH_USDT <br/> When status=unsettled, not specifying symbol will return unsettled orders for all trading pairs<br/>When status=settled, symbol parameter must be given</td>
</tr>
<tr>
<td>start_time</td>
<td>long</td>
<td>no</td>
<td>limit the last creation time of the returned delegate</td>
</tr>
<tr>
<td>end_time</td>
<td>long</td>
<td>no</td>
<td>limit the last creation time of the returned delegate</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>no</td>
<td>delegate update id<br/>limit return delegate&#39;s maximum update id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>no</td>
<td>delegate update id<br/>limit return delegate&#39;s minimum update id</td>
</tr>
<tr>
<td>limit</td>
<td>long</td>
<td>No</td>
<td>Specify the maximum number of delegates to return</td>
</tr>
</tbody></table>

<ul>
<li><p>Parameter combinations and data sources supported by this interface</p>

<ul>
<li>ids</li>
<li>status=unsettled + symbol</li>
<li>status=settled + symbol + start_time</li>
<li>status=settled + symbol + start_time + limit</li>
<li>status=settled + symbol + end_time</li>
<li>status=settled + symbol + end_time + limit</li>
<li>status=settled + symbol + start_time + end_time</li>
<li>status=settled + symbol + start_time + end_time + limit</li>
<li>status=settled + symbol + before</li>
<li>status=settled + symbol + before + limit</li>
<li>status=settled + symbol + after</li>
<li>status=settled + symbol + after + limit</li>
</ul></li>
</ul>

<blockquote>
<p>The returned unsettled delegates are sorted by creation time
The returned settled orders are sorted by settlement time from earliest to latest</p>
</blockquote>
<h2 id='cancel-orders'>Cancel Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">ids</span><span class="p">:</span><span class="dl">'</span><span class="s1">14244173146202090</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/order</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="k">delete</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'ids'</span><span class="p">:</span> <span class="s">'14245272657638034'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/order'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/order"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">ids</span> <span class="p">=</span> <span class="s">"15741707974869000"</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="kt">var</span> <span class="n">httpMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Delete</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
             <span class="p">{</span>
                 <span class="n">Content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">)</span>
             <span class="p">};</span>

             <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">SendAsync</span><span class="p">(</span><span class="n">httpMessage</span><span class="p">);</span>

             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>

          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Revoke the delegation with the specified id</strong></p>

<ul>
<li>Request method DELETE</li>
<li>Request path /v4/cbu/userdata/order</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td>string</td>
<td>yes</td>
<td>order id<br>The order id can be assigned by the exchange,<br/>or user-defined (use the client_order_id parameter when submitting the order). <br>When using a custom id, you need to add a &quot;c:&quot; prefix before the id. <br/>For example: the custom id &quot;123&quot; is used when submitting the order, and &quot;c:123&quot; must be used when canceling the order. <br/>Multiple delegate ids can be specified in the following form<br/> &quot;123,124,125,c:200&quot;</td>
</tr>
</tbody></table>

<blockquote>
<p>If the order with the specified id has been settled, or there is no order with the specified id, you will receive a -3004 error.</p>
</blockquote>
<h2 id='cancel-all-orders'>Cancel all Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/order</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="k">delete</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/order'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>

    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/order"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="kt">var</span> <span class="n">httpMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Delete</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
             <span class="p">{</span>
                 <span class="n">Content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">)</span>
             <span class="p">};</span>

             <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">SendAsync</span><span class="p">(</span><span class="n">httpMessage</span><span class="p">);</span>

             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>

          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Revoke all delegations</strong></p>

<ul>
<li>Request method DELETE</li>
<li>Request path /v4/cbu/userdata/order</li>
<li>Permissions: Trade</li>
<li>Request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>False</td>
<td>Trade pair codes <br/> 4BTC_USDT, 4ETH_USDT etc.</td>
</tr>
</tbody></table>

<blockquote>
<p>Returns an empty object if the request is executed correctly, otherwise returns an error message</p>
</blockquote>
<h2 id='get-fills'>Get fills</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;symbol=4BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/fills?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/fills'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;symbol=4BTC_USDT'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/fills"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"limit=2&amp;symbol=4BTC_USDT"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="err">i:</span><span class="w"> </span><span class="err">fill</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">o:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">s:</span><span class="w"> </span><span class="err">pair</span><span class="w">
    </span><span class="err">T:</span><span class="w"> </span><span class="err">detail</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">t:</span><span class="w"> </span><span class="err">time</span><span class="w">
    </span><span class="err">p:</span><span class="w"> </span><span class="err">price</span><span class="w">
    </span><span class="err">q:</span><span class="w"> </span><span class="err">quantity</span><span class="w">
    </span><span class="err">l:</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">taker</span><span class="w">
    </span><span class="err">f:</span><span class="w"> </span><span class="err">fee</span><span class="w">
    </span><span class="err">fb:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">discount</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get deal records</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/fills</li>
<li>Permission: View, Trade</li>
<li>request parameters (should be sorted)</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>string</td>
<td>false</td>
<td>Orders assigned by the exchange id<br/>Limits the return of only the transaction records for the specified order <br/>If you do not specify this parameter, please specify it symbol</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>false</td>
<td>Trade pair codes <br/>For example 4BTC_USDT, 4ETH_USDT etc.<br/>Qualifies that only the transaction records for the specified trading pair are returned <br/> If you do not specify this parameter, please specify it order_id</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>false</td>
<td>Limits the earliest time at which a deal record is returned</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>false</td>
<td>Limits the most recent time returned to the deal record</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>false</td>
<td>Deal history id<br/>Limits the maximum number of transaction records returned id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>false</td>
<td>Deal history id<br/>Limits the minimum number of transaction records returned id</td>
</tr>
<tr>
<td>limit</td>
<td>int32</td>
<td>false</td>
<td>Limits the maximum number of results returned <br/>The default value 100</td>
</tr>
</tbody></table>

<ul>
<li><p>The interface supports parameter combinations and data sources</p>

<ul>
<li>symbol  --&gt; database</li>
<li>symbol + limit  --&gt; database</li>
<li>symbol + start_time  --&gt; database</li>
<li>symbol + start_time + limit  --&gt; database</li>
<li>symbol + end_time  --&gt; database</li>
<li>symbol + end_time + limit  --&gt; database</li>
<li>symbol + start_time + end_time  --&gt; database</li>
<li>symbol + start_time + end_time + limit  --&gt; database</li>
<li>symbol + before  --&gt; database</li>
<li>symbol + before + limit  --&gt; database</li>
<li>symbol + after  --&gt; database</li>
<li>symbol + after + limit  --&gt; database</li>
<li>order_id  --&gt; database</li>
<li>order_id + limit  --&gt; database</li>
<li>order_id + before  --&gt; database</li>
<li>order_id + before + limit  --&gt; database</li>
</ul></li>
</ul>

<blockquote>
<p>The interface supports parameter combinations and data sources</p>
</blockquote>
<h2 id='create-an-plan-order'>Create an plan order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">cmd</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">symbol</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">side</span><span class="dl">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">plan_type</span><span class="dl">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">trigger_price</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">20000</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">book_type</span><span class="dl">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">price</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">20000</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">amount</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">0.001</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/planOrders</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'cmd'</span><span class="p">:</span> <span class="s">'open'</span><span class="p">,</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span><span class="p">,</span>
        <span class="s">'side'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'plan_type'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'trigger_price'</span><span class="p">:</span> <span class="s">'20000'</span><span class="p">,</span>
        <span class="s">'book_type'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'price'</span><span class="p">:</span> <span class="s">'20000'</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="s">'0.001'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/planOrders'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/planOrders"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">cmd</span> <span class="p">=</span> <span class="s">"open"</span><span class="p">,</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">plan_type</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                 <span class="n">trigger_price</span> <span class="p">=</span> <span class="s">"20000"</span><span class="p">,</span>
                 <span class="n">book_type</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                 <span class="n">price</span> <span class="p">=</span> <span class="s">"20000"</span><span class="p">,</span>
                 <span class="n">amount</span> <span class="p">=</span> <span class="s">"0.001"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="err">id:</span><span class="w"> </span><span class="err">plan</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">m:</span><span class="w"> </span><span class="err">pair</span><span class="w">
    </span><span class="err">s:</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w">
    </span><span class="err">sid:</span><span class="w"> </span><span class="err">source</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">oid:</span><span class="w"> </span><span class="err">other</span><span class="w"> </span><span class="err">plan</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">pid:</span><span class="w"> </span><span class="err">pisition</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">(For</span><span class="w"> </span><span class="err">sub-warehouses)</span><span class="p">,</span><span class="w">
    </span><span class="err">q:</span><span class="w"> </span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">delegates</span><span class="p">,</span><span class="w">
    </span><span class="err">t:</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">Stop</span><span class="w"> </span><span class="err">Loss</span><span class="w"> </span><span class="err">type.</span><span class="mi">1</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit、</span><span class="mi">2</span><span class="w"> </span><span class="err">Stop</span><span class="w"> </span><span class="err">Loss</span><span class="w">
    </span><span class="err">gt:</span><span class="w"> </span><span class="err">Trigger</span><span class="w"> </span><span class="err">mode</span><span class="w"> </span><span class="err">(last</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">trigger)</span><span class="w">
    </span><span class="err">bt:</span><span class="w"> </span><span class="err">How</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">place</span><span class="w"> </span><span class="err">an</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price，</span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price)</span><span class="w">
    </span><span class="err">pg:</span><span class="w"> </span><span class="err">Trigger</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">price</span><span class="w">
    </span><span class="err">pb:</span><span class="w"> </span><span class="err">Commission</span><span class="w"> </span><span class="err">price</span><span class="w">
    </span><span class="err">st:</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">status(</span><span class="mi">1</span><span class="w"> </span><span class="err">wait</span><span class="w"> </span><span class="err">trigger、</span><span class="mi">2</span><span class="w"> </span><span class="err">triggered、</span><span class="mi">3</span><span class="w"> </span><span class="err">canceled、</span><span class="mi">4</span><span class="w"> </span><span class="err">failed、</span><span class="mi">5</span><span class="w"> </span><span class="err">canceled</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">system)</span><span class="w">
    </span><span class="err">rs:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">reason</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">failure</span><span class="w">
    </span><span class="err">rsm:</span><span class="w"> </span><span class="err">Description</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">failure</span><span class="w">
    </span><span class="err">bid:</span><span class="w"> </span><span class="err">Delegate</span><span class="w"> </span><span class="err">orders</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">V:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">C:</span><span class="w"> </span><span class="err">create</span><span class="w"> </span><span class="err">time</span><span class="p">,</span><span class="w">
    </span><span class="err">U:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Submit a Take Profit and Stop Loss order</strong></p>

<ul>
<li>Request method POST</li>
<li>Request path /v4/cbu/userdata/planOrders</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cmd</td>
<td>string</td>
<td>True</td>
<td>open</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>True</td>
<td>Trade pair codes，如 For example 4BTC_USDT, 4ETH_USDT etc.</td>
</tr>
<tr>
<td>side</td>
<td>string</td>
<td>True</td>
<td>Position direction，Valid values 1Long positions、2Short positions</td>
</tr>
<tr>
<td>plan_type</td>
<td>string</td>
<td>True</td>
<td>Take Profit and Stop Loss Order Type，Valid values 1 Take Profit、2 Stop Loss</td>
</tr>
<tr>
<td>trigger_price</td>
<td>decimal</td>
<td>True</td>
<td>Trigger price</td>
</tr>
<tr>
<td>book_type</td>
<td>int</td>
<td>True</td>
<td>The delegate type，Valid values 1Market Take Profit and Stop Loss，2Limit Take Profit and Stop Loss</td>
</tr>
<tr>
<td>price</td>
<td>decimal</td>
<td>False</td>
<td>Limit order price</td>
</tr>
<tr>
<td>amount</td>
<td>decimal</td>
<td>True</td>
<td>Number of delegates</td>
</tr>
</tbody></table>
<h2 id='edit-an-plan-order'>Edit an plan order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">cmd</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">change</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">order_id</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">123</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">book_type</span><span class="dl">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">price</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">20000</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">amount</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">0.001</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/planOrders</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'cmd'</span><span class="p">:</span> <span class="s">'change'</span><span class="p">,</span>
        <span class="s">'order_id'</span><span class="p">:</span> <span class="s">'123'</span><span class="p">,</span>
        <span class="s">'book_type'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'price'</span><span class="p">:</span> <span class="s">'20000'</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="s">'0.001'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/planOrders'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/planOrders"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">cmd</span> <span class="p">=</span> <span class="s">"change"</span><span class="p">,</span>
                 <span class="n">order_id</span> <span class="p">=</span> <span class="s">"123"</span><span class="p">,</span>
                 <span class="n">book_type</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                 <span class="n">price</span> <span class="p">=</span> <span class="s">"20000"</span><span class="p">,</span>
                 <span class="n">amount</span> <span class="p">=</span> <span class="s">"0.001"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="err">id:</span><span class="w"> </span><span class="err">plan</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">m:</span><span class="w"> </span><span class="err">pair</span><span class="w">
    </span><span class="err">s:</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w">
    </span><span class="err">sid:</span><span class="w"> </span><span class="err">source</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">oid:</span><span class="w"> </span><span class="err">other</span><span class="w"> </span><span class="err">plan</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
    </span><span class="err">pid:</span><span class="w"> </span><span class="err">pisition</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">(For</span><span class="w"> </span><span class="err">sub-warehouses)</span><span class="p">,</span><span class="w">
    </span><span class="err">q:</span><span class="w"> </span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">delegates</span><span class="w">
    </span><span class="err">t:</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">Stop</span><span class="w"> </span><span class="err">Loss</span><span class="w"> </span><span class="err">type.</span><span class="mi">1</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit、</span><span class="mi">2</span><span class="w"> </span><span class="err">Stop</span><span class="w"> </span><span class="err">Loss</span><span class="w">
    </span><span class="err">gt:</span><span class="w"> </span><span class="err">Trigger</span><span class="w"> </span><span class="err">mode</span><span class="w"> </span><span class="err">(last</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">trigger)</span><span class="w">
    </span><span class="err">bt:</span><span class="w"> </span><span class="err">How</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">place</span><span class="w"> </span><span class="err">an</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price，</span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price)</span><span class="w">
    </span><span class="err">pg:</span><span class="w"> </span><span class="err">Trigger</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">price</span><span class="w">
    </span><span class="err">pb:</span><span class="w"> </span><span class="err">Commission</span><span class="w"> </span><span class="err">price</span><span class="w">
    </span><span class="err">st:</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">status(</span><span class="mi">1</span><span class="w"> </span><span class="err">wait</span><span class="w"> </span><span class="err">trigger、</span><span class="mi">2</span><span class="w"> </span><span class="err">triggered、</span><span class="mi">3</span><span class="w"> </span><span class="err">canceled、</span><span class="mi">4</span><span class="w"> </span><span class="err">failed、</span><span class="mi">5</span><span class="w"> </span><span class="err">canceled</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">system)</span><span class="w">
    </span><span class="err">rs:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">reason</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">failure</span><span class="w">
    </span><span class="err">rsm:</span><span class="w"> </span><span class="err">Description</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">failure</span><span class="w">
    </span><span class="err">bid:</span><span class="w"> </span><span class="err">Delegate</span><span class="w"> </span><span class="err">orders</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">V:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">C:</span><span class="w"> </span><span class="err">create</span><span class="w"> </span><span class="err">time</span><span class="p">,</span><span class="w">
    </span><span class="err">U:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Modify the Take Profit and Stop Loss order</strong></p>

<ol>
<li>You can only modify the order type + order price + the number of orders</li>
</ol>

<ul>
<li>Request method POST</li>
<li>Request path /v4/cbu/userdata/planOrders</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cmd</td>
<td>string</td>
<td>True</td>
<td>change</td>
</tr>
<tr>
<td>order_id</td>
<td>string</td>
<td>True</td>
<td>Take Profit and Stop Loss Order Type id</td>
</tr>
<tr>
<td>book_type</td>
<td>int</td>
<td>True</td>
<td>The delegate type，Valid values 1Market Take Profit and Stop Loss，2Limit Take Profit and Stop Loss</td>
</tr>
<tr>
<td>price</td>
<td>decimal</td>
<td>false</td>
<td>Limit order price</td>
</tr>
<tr>
<td>amount</td>
<td>decimal</td>
<td>True</td>
<td>Number of delegates</td>
</tr>
</tbody></table>
<h2 id='cancel-plan-orders'>Cancel Plan Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">ids</span><span class="p">:</span><span class="dl">'</span><span class="s1">14244173146202090</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/planOrders</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="k">delete</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'ids'</span><span class="p">:</span> <span class="s">'14245272657638034'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/planOrders'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/planOrders"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">ids</span> <span class="p">=</span> <span class="s">"15741707974869000"</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="kt">var</span> <span class="n">httpMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Delete</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
             <span class="p">{</span>
                 <span class="n">Content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">)</span>
             <span class="p">};</span>

             <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">SendAsync</span><span class="p">(</span><span class="n">httpMessage</span><span class="p">);</span>

             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>

          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Cancels the Take Profit and Stop Order with the specified ID</strong></p>

<ul>
<li>Request method DELETE</li>
<li>Request path /v4/cbu/userdata/planOrders</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td>string</td>
<td>True</td>
<td>id Delegate id <br/>You can specify multiple delegate IDs in the following form <br/> &quot;123,124&quot;</td>
</tr>
</tbody></table>

<blockquote>
<p>If a Take Profit and Stop Order with the specified ID has been triggered, or if there is no Take Profit and Stop Order with the specified ID, you will receive a -3004 error.</p>
</blockquote>
<h2 id='cancel-all-plan-orders'>Cancel all Plan Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/planOrders</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="k">delete</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/planOrders'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>

    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/planOrders"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="kt">var</span> <span class="n">httpMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Delete</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
             <span class="p">{</span>
                 <span class="n">Content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">)</span>
             <span class="p">};</span>

             <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">SendAsync</span><span class="p">(</span><span class="n">httpMessage</span><span class="p">);</span>

             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>

          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Cancel all Take Profit and Stop Loss orders</strong></p>

<ul>
<li>Request method DELETE</li>
<li>Request path /v4/cbu/userdata/planOrders</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>False</td>
<td>Trade pair codes<br/>For example 4BTC_USDT, 4ETH_USDT etc.</td>
</tr>
</tbody></table>

<blockquote>
<p>Returns an empty object if the request is executed correctly, otherwise returns an error message</p>
</blockquote>
<h2 id='get-plan-orders'>Get Plan Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;status=settled&amp;symbol=4BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/planOrders?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/planOrders'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;status=settled&amp;symbol=4BTC_USDT'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/planOrders"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"limit=2&amp;status=settled&amp;symbol=4BTC_USDT"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="nx">plan</span> <span class="nx">order</span> <span class="nx">id</span><span class="p">,</span>
    <span class="na">m</span><span class="p">:</span> <span class="nx">pair</span>
    <span class="na">s</span><span class="p">:</span> <span class="nx">side</span><span class="p">,</span>
    <span class="na">sid</span><span class="p">:</span> <span class="nx">source</span> <span class="nx">order</span> <span class="nx">id</span><span class="p">,</span>
    <span class="na">oid</span><span class="p">:</span> <span class="nx">other</span> <span class="nx">plan</span> <span class="nx">order</span> <span class="nx">id</span><span class="p">,</span>
    <span class="na">pid</span><span class="p">:</span> <span class="nx">pisition</span> <span class="nx">id</span> <span class="p">(</span><span class="nx">For</span> <span class="nx">sub</span><span class="o">-</span><span class="nx">warehouses</span><span class="p">),</span>
        <span class="na">q</span><span class="p">:</span> <span class="nb">Number</span> <span class="k">of</span> <span class="nx">delegates</span><span class="p">,</span>
    <span class="na">t</span><span class="p">:</span> <span class="nx">Take</span> <span class="nx">Profit</span> <span class="nx">and</span> <span class="nx">Stop</span> <span class="nx">Loss</span> <span class="nx">type</span><span class="p">.</span><span class="mi">1</span> <span class="nx">Take</span> <span class="nx">Profit</span><span class="err">、</span><span class="mi">2</span> <span class="nx">Stop</span> <span class="nx">Loss</span>
    <span class="na">gt</span><span class="p">:</span> <span class="nx">Trigger</span> <span class="nx">mode</span> <span class="p">(</span><span class="nx">last</span> <span class="nx">price</span> <span class="nx">trigger</span><span class="p">)</span>
    <span class="na">bt</span><span class="p">:</span> <span class="nx">How</span> <span class="nx">to</span> <span class="nx">place</span> <span class="nx">an</span> <span class="nx">order</span> <span class="p">(</span><span class="mi">1</span> <span class="nx">market</span> <span class="nx">price</span><span class="err">，</span><span class="mi">2</span> <span class="nx">limit</span> <span class="nx">price</span><span class="p">)</span>
    <span class="na">pg</span><span class="p">:</span> <span class="nx">Trigger</span> <span class="nx">the</span> <span class="nx">price</span>
    <span class="na">pb</span><span class="p">:</span> <span class="nx">Commission</span> <span class="nx">price</span>
    <span class="na">st</span><span class="p">:</span> <span class="nx">Take</span> <span class="nx">Profit</span> <span class="nx">stop</span> <span class="nx">stop</span> <span class="nx">order</span> <span class="nx">status</span><span class="p">(</span><span class="mi">1</span> <span class="nx">wait</span> <span class="nx">trigger</span><span class="err">、</span><span class="mi">2</span> <span class="nx">triggered</span><span class="err">、</span><span class="mi">3</span> <span class="nx">canceled</span><span class="err">、</span><span class="mi">4</span> <span class="nx">failed</span><span class="err">、</span><span class="mi">5</span> <span class="nx">canceled</span> <span class="nx">by</span> <span class="nx">system</span><span class="p">)</span>
    <span class="na">rs</span><span class="p">:</span> <span class="nx">The</span> <span class="nx">reason</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">failure</span>
    <span class="na">rsm</span><span class="p">:</span> <span class="nx">Description</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">failure</span>
    <span class="na">bid</span><span class="p">:</span> <span class="nx">Delegate</span> <span class="nx">orders</span>
    <span class="na">bid</span><span class="p">:</span> <span class="nx">c</span> <span class="nx">order</span> <span class="nx">id</span>
    <span class="na">V</span><span class="p">:</span> <span class="nx">update</span> <span class="nx">id</span>
    <span class="na">C</span><span class="p">:</span> <span class="nx">create</span> <span class="nx">time</span><span class="p">,</span>
    <span class="na">U</span><span class="p">:</span> <span class="nx">update</span> <span class="nx">time</span>
  <span class="p">}</span>
  <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>
<p><strong>All take profit and stop loss orders are not triggered</strong></p>

<ol>
<li>All take profit and stop loss orders are not triggered</li>
<li>Take Profit and Stop Loss orders within three months, with revocation and triggered</li>
<li>All take profit and stop loss orders are not triggered Obtain the Take Profit and Stop Loss order in the apiKey corresponding account that meets the following conditions</li>
</ol>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/planOrders</li>
<li>Permission: View, Trade</li>
<li>request parameters (should be sorted)</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td>string</td>
<td>false</td>
<td>Delegate id<br>The delegate id can be exchange-assigned，<br/> Multiple delegate IDs can be specified in the following form<br/>&quot;123,124,125&quot;</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>false</td>
<td>Valid values unsettled, settled<br/>unsettled Indicates that the take profit and stop loss order is obtained without triggering, and the returned result is sorted in reverse order of the order when the order was created and the returned results are sorted in reverse order according to the order when the order was created<br/>settled Indicates that the triggered Take Profit and Stop Loss order is obtained, and the returned result is sorted in reverse order of the order triggered by the order<br/>default value  unsettled</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>false</td>
<td>Trade pair codes，For example 4BTC_USDT, 4ETH_USDT etc.<br/>Multiple trading pair codes can be specified as follows<br/> /v4/cbu/userdata/orders?symbol=4BTC_USDT,4ETH_USDT <br/> when status=unsettled , Unsettled orders that do not specify a symbol will return all trading pairs<br/>when status=settled , The symbol parameter must be given</td>
</tr>
<tr>
<td>start_time</td>
<td>long</td>
<td>false</td>
<td>Limits the most recent creation time of the return delegate</td>
</tr>
<tr>
<td>end_time</td>
<td>long</td>
<td>false</td>
<td>Limits the most recent creation time of the return delegate</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>false</td>
<td>Delegate update ID<br/>Limits the maximum update id returned for the delegate</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>false</td>
<td>Delegate update ID<br/>Qualifies the minimum update id for the return delegate</td>
</tr>
<tr>
<td>limit</td>
<td>long</td>
<td>false</td>
<td>Specifies how many delegates are returned</td>
</tr>
</tbody></table>

<ul>
<li><p>The interface supports parameter combinations and data sources</p>

<ul>
<li>ids</li>
<li>status=unsettled + symbol</li>
<li>status=settled + symbol + start_time</li>
<li>status=settled + symbol + start_time + limit</li>
<li>status=settled + symbol + end_time</li>
<li>status=settled + symbol + end_time + limit</li>
<li>status=settled + symbol + start_time + end_time</li>
<li>status=settled + symbol + start_time + end_time + limit</li>
<li>status=settled + symbol + before</li>
<li>status=settled + symbol + before + limit</li>
<li>status=settled + symbol + after</li>
<li>status=settled + symbol + after + limit</li>
</ul></li>
</ul>

<blockquote>
<p>Returned unsettled delegates are sorted by creation time by earlier and most recent
The returned setled orders are sorted by settlement time by earlier and most recent</p>
</blockquote>
<h2 id='get-positions'>Get Positions</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">symbol=4BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/positions?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/positions'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'symbol=4BTC_USDT'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/positions"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"symbol=4BTC_USDT"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span> <span class="nx">position</span> <span class="nx">id</span><span class="p">,</span>
    <span class="na">ui</span><span class="p">:</span> <span class="nx">user</span> <span class="nx">id</span><span class="p">,</span>
    <span class="na">v</span><span class="p">:</span> <span class="nx">version</span><span class="p">,</span>
    <span class="na">m</span><span class="p">:</span> <span class="nx">pair</span> <span class="nx">symbol</span><span class="p">,</span>
    <span class="na">st</span><span class="p">:</span> <span class="nx">status</span><span class="p">,</span>
    <span class="na">sp</span><span class="p">:</span> <span class="nx">separate</span><span class="p">,</span>
    <span class="na">sd</span><span class="p">:</span> <span class="nx">side</span><span class="p">,</span>
    <span class="na">md</span><span class="p">:</span> <span class="nx">model</span><span class="p">,</span><span class="mi">1</span> <span class="nx">cross</span> <span class="nx">position</span><span class="p">,</span> <span class="mi">2</span> <span class="nx">Isolated</span> <span class="nx">position</span>
    <span class="na">l</span><span class="p">:</span> <span class="nx">leverage</span><span class="p">,</span>
    <span class="na">mg</span><span class="p">:</span> <span class="nx">margin</span><span class="p">,</span>
    <span class="na">hc</span><span class="p">:</span> <span class="nx">hold</span> <span class="nx">coin</span><span class="p">,</span>
    <span class="na">po</span><span class="p">:</span> <span class="nx">price</span> <span class="nx">open</span><span class="p">,</span>
    <span class="na">pa</span><span class="p">:</span> <span class="nx">price</span> <span class="nx">alert</span><span class="p">,</span>
    <span class="na">pf</span><span class="p">:</span> <span class="nx">price</span> <span class="nx">force</span><span class="p">,</span>
    <span class="na">pt</span><span class="p">:</span> <span class="nx">profit</span><span class="p">,</span>
    <span class="na">f</span><span class="p">:</span> <span class="nx">fee</span><span class="p">,</span>
    <span class="na">fb</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">fb0</span><span class="p">:</span> <span class="nx">fee</span> <span class="nx">bix0</span><span class="p">,</span>
    <span class="na">ps</span><span class="p">:</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">stop</span><span class="o">-</span><span class="nx">loss</span> <span class="nx">orders</span>
    <span class="na">pp</span><span class="p">:</span> <span class="nb">Number</span> <span class="k">of</span> <span class="nx">take</span> <span class="nx">profit</span> <span class="nx">orders</span>
    <span class="na">lc</span><span class="p">:</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">remaining</span> <span class="nx">flats</span>
    <span class="na">cc</span><span class="p">:</span> <span class="nb">Number</span> <span class="k">of</span> <span class="nx">closed</span> <span class="nx">positions</span> <span class="p">(</span><span class="nx">recorded</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">sub</span><span class="o">-</span><span class="nx">position</span><span class="p">)</span>
    <span class="na">pc</span><span class="p">:</span> <span class="nx">Average</span> <span class="nx">closing</span> <span class="nx">price</span> <span class="p">(</span><span class="nx">recorded</span> <span class="nx">by</span> <span class="nx">sub</span><span class="o">-</span><span class="nx">positions</span><span class="p">)</span>
    <span class="na">C</span><span class="p">:</span> <span class="nx">creation</span> <span class="nx">time</span>
    <span class="na">ud</span><span class="p">:</span> <span class="nx">update</span> <span class="nx">id</span><span class="p">,</span>
    <span class="na">U</span><span class="p">:</span> <span class="nx">Update</span> <span class="nx">time</span>
  <span class="p">}</span>
  <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>
<p><strong>Get the position of the corresponding account of apikey</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/positions</li>
<li>Permission: View, Trade</li>
<li>request parameters (should be sorted)</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>false</td>
<td>Trade pair codes，For example 4BTC_USDT, 4ETH_USDT etc.</td>
</tr>
<tr>
<td>side</td>
<td>int</td>
<td>false</td>
<td>Position direction, side only works when symbol is active</td>
</tr>
</tbody></table>
<h2 id='change-position-mode'>Change Position Mode</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">cmd</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">changeMode</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">symbol</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">mode</span><span class="dl">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">leverage_long</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">leverage_short</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/positions</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'cmd'</span><span class="p">:</span> <span class="s">'changeMode'</span><span class="p">,</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span><span class="p">,</span>
        <span class="s">'mode'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'leverage_long'</span><span class="p">:</span> <span class="s">'2'</span><span class="p">,</span>
        <span class="s">'leverage_short'</span><span class="p">:</span> <span class="s">'4'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/positions'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/positions"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">cmd</span> <span class="p">=</span> <span class="s">"changeMode"</span><span class="p">,</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">mode</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">plan_type</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                 <span class="n">leverage_long</span> <span class="p">=</span> <span class="s">"2"</span><span class="p">,</span>
                 <span class="n">leverage_short</span> <span class="p">=</span> <span class="s">"4"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Modify the position mode</strong></p>

<ol>
<li>Switch between cross position mode and Isolated position mode</li>
<li>Leverage multiple adjustment</li>
</ol>

<ul>
<li>Request method POST</li>
<li>Request path /v4/cbu/userdata/positions</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cmd</td>
<td>string</td>
<td>true</td>
<td>changeMode</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>true</td>
<td>Trade pairs</td>
</tr>
<tr>
<td>mode</td>
<td>int</td>
<td>true</td>
<td>Position mode, valid value 1 cross position, 2 Isolated position</td>
</tr>
<tr>
<td>leverage_long</td>
<td>int</td>
<td>true</td>
<td>Leverage multiples for long positions</td>
</tr>
<tr>
<td>leverage_short</td>
<td>int</td>
<td>true</td>
<td>Short leverage multiple, in full mode mode, the value should be equal to leverage_long</td>
</tr>
</tbody></table>
<h2 id='change-position-margin'>Change Position Margin</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">cmd</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">changeMargin</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">symbol</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">side</span><span class="dl">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">margin</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/positions</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'cmd'</span><span class="p">:</span> <span class="s">'changeMargin'</span><span class="p">,</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span><span class="p">,</span>
        <span class="s">'side'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'margin'</span><span class="p">:</span> <span class="s">'2'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/positions'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/positions"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">cmd</span> <span class="p">=</span> <span class="s">"changeMargin"</span><span class="p">,</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">margin</span> <span class="p">=</span> <span class="s">"2"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Adjust the margin of the position</strong></p>

<ol>
<li>The Isolated position mode can only be modified</li>
</ol>

<ul>
<li>Request method POST</li>
<li>Request path /v4/cbu/userdata/positions</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cmd</td>
<td>string</td>
<td>true</td>
<td>changeMargin</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>true</td>
<td>Trading pair</td>
</tr>
<tr>
<td>side</td>
<td>int</td>
<td>true</td>
<td>Position direction, valid value 1 long position, 2 short position</td>
</tr>
<tr>
<td>margin</td>
<td>Decimal</td>
<td>true</td>
<td>Margin adjustment quantity</td>
</tr>
</tbody></table>
<h2 id='clear-position-hold'>Clear Position Hold</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">cmd</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">clear</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">symbol</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">side</span><span class="dl">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/positions</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'cmd'</span><span class="p">:</span> <span class="s">'clear'</span><span class="p">,</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span><span class="p">,</span>
        <span class="s">'side'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/positions'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/positions"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">cmd</span> <span class="p">=</span> <span class="s">"clear"</span><span class="p">,</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Close all positions in the position</strong></p>

<ol>
<li>Close positions quickly at market prices</li>
<li>In extreme markets, there may be a situation where there are insufficient counterpart orders that cannot be completely closed</li>
<li>The closing price will not exceed the out-of-position range</li>
</ol>

<ul>
<li>Request method POST</li>
<li>Request path /v4/cbu/userdata/positions</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cmd</td>
<td>string</td>
<td>true</td>
<td>clear</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>false</td>
<td>Trading pair</td>
</tr>
<tr>
<td>side</td>
<td>int</td>
<td>false</td>
<td>Position direction, valid value 1 long position, 2 short position <br/> When symbol works, the side only works</td>
</tr>
</tbody></table>

<ul>
<li><p>The interface supports parameter combinations and data sources</p>

<ul>
<li>cmd=clear --&gt; Close all positions</li>
<li>cmd=clear + symbol --&gt; Closes all positions of the specified trade</li>
<li>cmd=clear + symbol + side --&gt; Closes a position held on the specified trade pair for the specified position</li>
</ul></li>
</ul>
<h2 id='oppose-position'>Oppose Position</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">cmd</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">oppose</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">symbol</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">side</span><span class="dl">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">bodyStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/positions</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'cmd'</span><span class="p">:</span> <span class="s">'oppose'</span><span class="p">,</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'4BTC_USDT'</span><span class="p">,</span>
        <span class="s">'side'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">body_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/positions'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/positions"</span><span class="p">;</span>

             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">cmd</span> <span class="p">=</span> <span class="s">"oppose"</span><span class="p">,</span>
                 <span class="n">symbol</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">body_str</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">body_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span><span class="p">;</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign_str</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">body_str</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Open a position in the opposite direction</strong></p>

<ol>
<li>Quickly close the current position at the market price</li>
<li>Open a position in the opposite direction of the market price quickly</li>
<li>The opening and closing prices are not allowed to exceed the range of the out-of-the-position price</li>
<li>Under extreme market conditions, there may be a situation where the position cannot be completely closed, in which case the position will not continue to be closed, nor will it continue to open the position</li>
<li>In extreme market conditions, there may be a situation where the position cannot be fully filled, in which case the position will not continue to be opened</li>
</ol>

<ul>
<li>Request method POST</li>
<li>Request path /v4/cbu/userdata/positions</li>
<li>Permission: Trade</li>
<li>request parameters</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cmd</td>
<td>string</td>
<td>true</td>
<td>oppose</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>true</td>
<td>Trading pair</td>
</tr>
<tr>
<td>side</td>
<td>int</td>
<td>true</td>
<td>Position direction, valid value 1 long position, 2 short position</td>
</tr>
</tbody></table>
<h2 id='get-position-logs'>Get Position Logs</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api.bibox.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;symbol=4BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">signStr</span> <span class="o">=</span> <span class="nx">expireTime</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">:</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">queryStr</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">signStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="err">/v4/cbu/userdata/dealLog?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Api-Sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api.bibox.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v4/cbu/userdata/dealLog'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;symbol=4BTC_USDT'</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="s">':'</span> <span class="o">+</span> <span class="n">query_str</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'Bibox-Api-Sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">endpoints</span> <span class="p">=</span> <span class="s">"https://api.bibox.com/api"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">"/v4/cbu/userdata/dealLog"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">query_str</span> <span class="p">=</span> <span class="s">"limit=2&amp;symbol=4BTC_USDT"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span> <span class="p">+</span> <span class="s">":"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
             <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="n">endpoints</span> <span class="p">+</span> <span class="n">path</span> <span class="p">+</span> <span class="s">"?"</span> <span class="p">+</span> <span class="n">query_str</span><span class="p">;</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="err">i:</span><span class="w"> </span><span class="err">'</span><span class="mi">1125899906843599056</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">log</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">m:</span><span class="w"> </span><span class="err">'</span><span class="mi">4</span><span class="err">STEPN_USDT'</span><span class="p">,</span><span class="w"> </span><span class="err">pair</span><span class="w">
    </span><span class="err">y:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">log</span><span class="w"> </span><span class="err">type.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">positions</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">reduction</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">reduce</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">risk</span><span class="w"> </span><span class="err">level</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">positions</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">empty</span><span class="w"> </span><span class="err">positions</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="err">ADL</span><span class="w">
    </span><span class="err">p:</span><span class="w"> </span><span class="err">'</span><span class="mi">1125899906842624053</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">Positions</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="err">sd:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">direction</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">long</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">short</span><span class="w"> </span><span class="err">positions</span><span class="w">
    </span><span class="err">md:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">mode</span><span class="p">,</span><span class="w"> </span><span class="err">valid</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">cross</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">Isolated</span><span class="w"> </span><span class="err">position</span><span class="w">
    </span><span class="err">hc:</span><span class="w"> </span><span class="mi">3000</span><span class="p">,</span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">positions</span><span class="w">
    </span><span class="err">hd:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="err">The</span><span class="w"> </span><span class="err">amount</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">change</span><span class="w">
    </span><span class="err">o:</span><span class="w"> </span><span class="mf">1.3592983336</span><span class="p">,</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">average</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">opened</span><span class="w">
    </span><span class="err">pl:</span><span class="w"> </span><span class="mf">1.3336</span><span class="p">,</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">used</span><span class="w">
    </span><span class="err">fi:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">profit</span><span class="w">
    </span><span class="err">f:</span><span class="w"> </span><span class="mf">0.0106688</span><span class="p">,</span><span class="w"> </span><span class="err">fee</span><span class="w">
    </span><span class="err">fb:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">Coupon</span><span class="w"> </span><span class="err">credit</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
    </span><span class="err">t:</span><span class="w"> </span><span class="mi">1653541169000</span><span class="w"> </span><span class="err">Time</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Get deal records</strong></p>

<ul>
<li>Request method GET</li>
<li>Request path /v4/cbu/userdata/dealLog</li>
<li>Permission: View, Trade</li>
<li>request parameters (should be sorted)</li>
</ul>

<table><thead>
<tr>
<th>Parameter name</th>
<th>Parameter type</th>
<th>Required or not</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>false</td>
<td>Trade pair codes <br/>For example 4BTC_USDT, 4ETH_USDT etc.<br/>Qualifies that only the transaction records for the specified trading pair are returned<br/>If you do not specify this parameter, specify it order_id</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>false</td>
<td>Limits the earliest time at which a deal record is returned</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>false</td>
<td>Limits the most recent time returned to the deal record</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>false</td>
<td>Deal history id<br/>Limits the maximum number of transaction records returned id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>false</td>
<td>Deal history id<br/>Limits the minimum number of transaction records returned id</td>
</tr>
<tr>
<td>limit</td>
<td>int32</td>
<td>false</td>
<td>Limits the maximum number of results returned<br/>default value  100</td>
</tr>
</tbody></table>

<ul>
<li><p>The interface supports parameter combinations and data sources</p>

<ul>
<li>symbol  --&gt; database</li>
<li>symbol + limit  --&gt; database</li>
<li>symbol + start_time  --&gt; database</li>
<li>symbol + start_time + limit  --&gt; database</li>
<li>symbol + end_time  --&gt; database</li>
<li>symbol + end_time + limit  --&gt; database</li>
<li>symbol + start_time + end_time  --&gt; database</li>
<li>symbol + start_time + end_time + limit  --&gt; database</li>
<li>symbol + before  --&gt; database</li>
<li>symbol + before + limit  --&gt; database</li>
<li>symbol + after  --&gt; database</li>
<li>symbol + after + limit  --&gt; database</li>
</ul></li>
</ul>
<h1 id='user-data-streams'>User Data Streams</h1><h2 id='overview-2'>Overview</h2>
<blockquote>
<p>例子</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://user-wss.bibox360.com/cbu</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e2bd17ff73e8531c0f3c26f93e48bfa402a3b13</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">ca55beb9e45d4f30b3959b464402319b9e12bac7</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>


<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">expireTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">20000</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">""</span> <span class="o">+</span> <span class="nx">expireTime</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
  <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">,</span><span class="dl">""</span><span class="p">,{</span><span class="na">headers</span><span class="p">:{</span>
      <span class="dl">'</span><span class="s1">BIBOX-API-KEY</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">BIBOX-API-SIGN</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">Bibox-Expire-Time</span><span class="dl">'</span><span class="p">:</span> <span class="nx">expireTime</span><span class="p">,</span>
    <span class="p">}});</span>
  <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">ws</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
    <span class="p">},</span><span class="mi">30000</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span>  <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error </span><span class="dl">'</span><span class="p">,</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span> <span class="c1">// the data may be is error message,check the data's stream is order or account</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">websocket</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://user-wss.bibox360.com/cbu'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e2bd17ff73e8531c0f3c26f93e48bfa402a3b13'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'ca55beb9e45d4f30b3959b464402319b9e12bac7'</span>

<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### opened ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="c1"># websocket.enableTrace(True)
</span>
    <span class="n">expireTime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">20000</span>
    <span class="n">sign_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">sign_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'BIBOX-API-KEY'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'BIBOX-API-SIGN'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'Bibox-Expire-Time'</span><span class="p">:</span> <span class="n">expireTime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.WebSockets</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Send</span><span class="p">(</span><span class="n">ClientWebSocket</span> <span class="n">ws</span><span class="p">,</span> <span class="kt">string</span> <span class="n">data</span><span class="p">)</span> <span class="p">=&gt;</span>
            <span class="k">await</span> <span class="n">ws</span><span class="p">.</span><span class="nf">SendAsync</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">WebSocketMessageType</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="k">true</span><span class="p">,</span> <span class="n">CancellationToken</span><span class="p">.</span><span class="n">None</span><span class="p">);</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Receive</span><span class="p">(</span><span class="n">ClientWebSocket</span> <span class="n">ws</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ArraySegment</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(</span><span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">2048</span><span class="p">]);</span>
            <span class="k">do</span>
            <span class="p">{</span>
                <span class="n">WebSocketReceiveResult</span> <span class="n">result</span><span class="p">;</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ms</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">())</span>
                <span class="p">{</span>
                    <span class="k">do</span>
                    <span class="p">{</span>
                        <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">ws</span><span class="p">.</span><span class="nf">ReceiveAsync</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">CancellationToken</span><span class="p">.</span><span class="n">None</span><span class="p">);</span>
                        <span class="n">ms</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">buffer</span><span class="p">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">buffer</span><span class="p">.</span><span class="n">Offset</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">while</span> <span class="p">(!</span><span class="n">result</span><span class="p">.</span><span class="n">EndOfMessage</span><span class="p">);</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">MessageType</span> <span class="p">==</span> <span class="n">WebSocketMessageType</span><span class="p">.</span><span class="n">Close</span><span class="p">)</span>
                        <span class="k">break</span><span class="p">;</span>

                    <span class="n">ms</span><span class="p">.</span><span class="nf">Seek</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">SeekOrigin</span><span class="p">.</span><span class="n">Begin</span><span class="p">);</span>
                    <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">))</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="k">await</span> <span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEndAsync</span><span class="p">());</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmwindow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">+</span> <span class="n">tmwindow</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">HMACSHA256</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACSHA256</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
            <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://user-wss.bibox360.com/cbu"</span><span class="p">;</span>

            <span class="kt">string</span> <span class="n">expireTime</span> <span class="p">=</span> <span class="nf">GetExpireTime</span><span class="p">(</span><span class="m">20000</span><span class="p">);</span>
            <span class="kt">string</span> <span class="n">sign_str</span> <span class="p">=</span> <span class="n">expireTime</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacSha256</span><span class="p">(</span><span class="n">sign_str</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

            <span class="k">do</span>
            <span class="p">{</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ClientWebSocket</span><span class="p">())</span>
                    <span class="k">try</span>
                    <span class="p">{</span>
                        <span class="n">ws</span><span class="p">.</span><span class="n">Options</span><span class="p">.</span><span class="nf">SetRequestHeader</span><span class="p">(</span><span class="s">"Bibox-Api-Key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
                        <span class="n">ws</span><span class="p">.</span><span class="n">Options</span><span class="p">.</span><span class="nf">SetRequestHeader</span><span class="p">(</span><span class="s">"Bibox-Api-Sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
                        <span class="n">ws</span><span class="p">.</span><span class="n">Options</span><span class="p">.</span><span class="nf">SetRequestHeader</span><span class="p">(</span><span class="s">"Bibox-Expire-Time"</span><span class="p">,</span> <span class="n">expireTime</span><span class="p">);</span>

                        <span class="k">await</span> <span class="n">ws</span><span class="p">.</span><span class="nf">ConnectAsync</span><span class="p">(</span><span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="n">wsuri</span><span class="p">),</span> <span class="n">CancellationToken</span><span class="p">.</span><span class="n">None</span><span class="p">);</span>

                        <span class="k">await</span> <span class="nf">Receive</span><span class="p">(</span><span class="n">ws</span><span class="p">);</span>

                    <span class="p">}</span>
                    <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"ERROR - </span><span class="p">{</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
                    <span class="p">}</span>
            <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<p>Using the Websocket push service, you can timely obtain the balance, order, position and take profit and stop loss order change information of the account in a timely manner</p>

<p><strong>Connect to the Websocket server</strong></p>

<p>Use the following URL to connect to the Websocket server:</p>

<p>wss://user-wss.bibox360.com/cbu</p>

<p><strong>When connecting, append the following HTTP request headers</strong></p>

<ul>
<li>BIBOX-API-KEY</li>
<li>BIBOX-API-SIGN</li>
<li>Bibox-Expire-Time</li>
</ul>

<p><em>For details, see the [Authentication] #authentication section</em></p>

<blockquote>
<p>Data flow
After the connection is successfully established, the client will receive the balance change information and the entrustment change information of the apikey corresponding account. The format is as follows:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"account"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Account</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"position"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"order"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"planOrder"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">Plan</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='account'>Account</h2>
<p><strong>When the account balance changes, you will receive an account event</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"account"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="err">c:</span><span class="w"> </span><span class="err">'USDT'</span><span class="p">,</span><span class="w"> </span><span class="err">Currency</span><span class="w"> </span><span class="err">symbol</span><span class="w">
        </span><span class="err">b:</span><span class="w"> </span><span class="err">'</span><span class="mf">8247.1187293513</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">Account</span><span class="w"> </span><span class="err">available</span><span class="w"> </span><span class="err">balance</span><span class="w">
        </span><span class="err">ff:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">Pending</span><span class="w"> </span><span class="err">orders</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">frozen</span><span class="w">
        </span><span class="err">fc:</span><span class="w"> </span><span class="err">'</span><span class="mf">346.73844114</span><span class="err">'</span><span class="p">,</span><span class="err">Full</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">pending</span><span class="w"> </span><span class="err">orders</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">frozen</span><span class="w">
        </span><span class="err">mf:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="err">Margin</span><span class="w"> </span><span class="err">Isolated</span><span class="w"> </span><span class="err">positions</span><span class="w">
        </span><span class="err">mc:</span><span class="w"> </span><span class="err">'</span><span class="mf">1396.55822362</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">margin</span><span class="w"> </span><span class="err">Full</span><span class="w"> </span><span class="err">positions</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='orders'>Orders</h2>
<p><strong>When the delegate changes, you receive an order event</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"order"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">

        </span><span class="err">i:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
       </span><span class="err">I:</span><span class="w"> </span><span class="err">client</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
       </span><span class="err">m:</span><span class="w"> </span><span class="err">pair</span><span class="w">
       </span><span class="err">T:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price，</span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price)</span><span class="w">
       </span><span class="err">s:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">side</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">long，</span><span class="mi">2</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">short，</span><span class="mi">3</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">long，</span><span class="mi">4</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">short)</span><span class="w">
       </span><span class="err">Q:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
       </span><span class="err">P:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
       </span><span class="err">S:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">status</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">pending，</span><span class="mi">2</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">part，</span><span class="mi">3</span><span class="w"> </span><span class="err">filled，</span><span class="mi">4</span><span class="w"> </span><span class="err">cancelled</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">part，</span><span class="mi">5</span><span class="w"> </span><span class="err">canceled，</span><span class="mi">100</span><span class="w"> </span><span class="err">fail)</span><span class="w">
       </span><span class="err">r:</span><span class="w"> </span><span class="err">failure</span><span class="w"> </span><span class="err">reason</span><span class="w">
       </span><span class="err">M:</span><span class="w"> </span><span class="err">failure</span><span class="w"> </span><span class="err">description</span><span class="w">
       </span><span class="err">E:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
       </span><span class="err">e:</span><span class="w"> </span><span class="err">Average</span><span class="w"> </span><span class="err">transaction</span><span class="w"> </span><span class="err">price</span><span class="w">
       </span><span class="err">C:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">Creation</span><span class="w"> </span><span class="err">Time</span><span class="w">
       </span><span class="err">U:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
       </span><span class="err">V:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
       </span><span class="err">z:</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">Freeze</span><span class="w"> </span><span class="err">Assets</span><span class="w">
       </span><span class="err">rm:</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
       </span><span class="err">rt:</span><span class="w"> </span><span class="err">taker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
       </span><span class="err">of:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">source</span><span class="w">
       </span><span class="err">pid:</span><span class="w"> </span><span class="err">corresponding</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">id</span><span class="w">
       </span><span class="err">ot:</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">type</span><span class="w"> </span><span class="err">that</span><span class="w"> </span><span class="err">contains</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">take</span><span class="w"> </span><span class="err">profit</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">loss</span><span class="w"> </span><span class="err">order</span><span class="w">
       </span><span class="err">f:</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
       </span><span class="err">fb:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="w">
       </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="err">deduct</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
       </span><span class="err">n:</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">transactions</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='positions'>Positions</h2>
<p>** When a position changes, a position event is received**</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"position"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="err">id:</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
        </span><span class="err">ui:</span><span class="w"> </span><span class="err">user</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
        </span><span class="err">v:</span><span class="w"> </span><span class="err">version</span><span class="p">,</span><span class="w">
        </span><span class="err">m:</span><span class="w"> </span><span class="err">pair</span><span class="w"> </span><span class="err">symbol</span><span class="p">,</span><span class="w">
        </span><span class="err">st:</span><span class="w"> </span><span class="err">status</span><span class="p">,</span><span class="w">
        </span><span class="err">sp:</span><span class="w"> </span><span class="err">separate</span><span class="p">,</span><span class="w">
        </span><span class="err">sd:</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w">
        </span><span class="err">md:</span><span class="w"> </span><span class="err">model</span><span class="p">,</span><span class="mi">1</span><span class="w"> </span><span class="err">cross</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">Isolated</span><span class="w"> </span><span class="err">position</span><span class="w">
        </span><span class="err">l:</span><span class="w"> </span><span class="err">leverage</span><span class="p">,</span><span class="w">
        </span><span class="err">mg:</span><span class="w"> </span><span class="err">margin</span><span class="p">,</span><span class="w">
        </span><span class="err">hc:</span><span class="w"> </span><span class="err">hold</span><span class="w"> </span><span class="err">coin</span><span class="p">,</span><span class="w">
        </span><span class="err">po:</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">open</span><span class="p">,</span><span class="w">
        </span><span class="err">pa:</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">alert</span><span class="p">,</span><span class="w">
        </span><span class="err">pf:</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">force</span><span class="p">,</span><span class="w">
        </span><span class="err">pt:</span><span class="w"> </span><span class="err">profit</span><span class="p">,</span><span class="w">
        </span><span class="err">f:</span><span class="w"> </span><span class="err">fee</span><span class="p">,</span><span class="w">
        </span><span class="err">fb:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">bix</span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="err">ps:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">stop-loss</span><span class="w"> </span><span class="err">orders</span><span class="w">
        </span><span class="err">pp:</span><span class="w"> </span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">take</span><span class="w"> </span><span class="err">profit</span><span class="w"> </span><span class="err">orders</span><span class="w">
        </span><span class="err">lc:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">remaining</span><span class="w"> </span><span class="err">flats</span><span class="w">
        </span><span class="err">cc:</span><span class="w"> </span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">closed</span><span class="w"> </span><span class="err">positions</span><span class="w"> </span><span class="err">(recorded</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">sub-position)</span><span class="w">
        </span><span class="err">pc:</span><span class="w"> </span><span class="err">Average</span><span class="w"> </span><span class="err">closing</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">(recorded</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">sub-positions)</span><span class="w">
        </span><span class="err">C:</span><span class="w"> </span><span class="err">creation</span><span class="w"> </span><span class="err">time</span><span class="w">
        </span><span class="err">ud:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
        </span><span class="err">U:</span><span class="w"> </span><span class="err">Update</span><span class="w"> </span><span class="err">time</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='plan-orders'>Plan Orders</h2>
<p><strong>When the Take Profit and Stop Loss order is changed, you receive a planOrder event</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"planOrder"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="err">id:</span><span class="w"> </span><span class="err">plan</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
        </span><span class="err">m:</span><span class="w"> </span><span class="err">pair</span><span class="w">
        </span><span class="err">s:</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w">
        </span><span class="err">sid:</span><span class="w"> </span><span class="err">source</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
        </span><span class="err">oid:</span><span class="w"> </span><span class="err">other</span><span class="w"> </span><span class="err">plan</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
        </span><span class="err">pid:</span><span class="w"> </span><span class="err">pisition</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">(For</span><span class="w"> </span><span class="err">sub-warehouses)</span><span class="p">,</span><span class="w">
        </span><span class="err">q:</span><span class="w"> </span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">delegates</span><span class="p">,</span><span class="w">
        </span><span class="err">t:</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">Stop</span><span class="w"> </span><span class="err">Loss</span><span class="w"> </span><span class="err">type.</span><span class="mi">1</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit、</span><span class="mi">2</span><span class="w"> </span><span class="err">Stop</span><span class="w"> </span><span class="err">Loss</span><span class="w">
        </span><span class="err">gt:</span><span class="w"> </span><span class="err">Trigger</span><span class="w"> </span><span class="err">mode</span><span class="w"> </span><span class="err">(last</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">trigger)</span><span class="w">
        </span><span class="err">bt:</span><span class="w"> </span><span class="err">How</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">place</span><span class="w"> </span><span class="err">an</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">(</span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price，</span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price)</span><span class="w">
        </span><span class="err">pg:</span><span class="w"> </span><span class="err">Trigger</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">price</span><span class="w">
        </span><span class="err">pb:</span><span class="w"> </span><span class="err">Commission</span><span class="w"> </span><span class="err">price</span><span class="w">
        </span><span class="err">st:</span><span class="w"> </span><span class="err">Take</span><span class="w"> </span><span class="err">Profit</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">stop</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">status(</span><span class="mi">1</span><span class="w"> </span><span class="err">wait</span><span class="w"> </span><span class="err">trigger、</span><span class="mi">2</span><span class="w"> </span><span class="err">triggered、</span><span class="mi">3</span><span class="w"> </span><span class="err">canceled、</span><span class="mi">4</span><span class="w"> </span><span class="err">failed、</span><span class="mi">5</span><span class="w"> </span><span class="err">canceled</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">system)</span><span class="w">
        </span><span class="err">rs:</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">reason</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">failure</span><span class="w">
        </span><span class="err">rsm:</span><span class="w"> </span><span class="err">Description</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">failure</span><span class="w">
        </span><span class="err">bid:</span><span class="w"> </span><span class="err">Delegate</span><span class="w"> </span><span class="err">orders</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="err">V:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="err">C:</span><span class="w"> </span><span class="err">create</span><span class="w"> </span><span class="err">time</span><span class="p">,</span><span class="w">
        </span><span class="err">U:</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='fills'>Fills</h2>
<p><strong>When a fill occurs on an order, a FILL event is received</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"fill"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="err">i:</span><span class="w"> </span><span class="err">fill</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="err">o:</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="err">s:</span><span class="w"> </span><span class="err">pair</span><span class="w">
        </span><span class="err">T:</span><span class="w"> </span><span class="err">detail</span><span class="w"> </span><span class="err">id</span><span class="p">,</span><span class="w">
        </span><span class="err">t:</span><span class="w"> </span><span class="err">time</span><span class="w">
        </span><span class="err">p:</span><span class="w"> </span><span class="err">price</span><span class="w">
        </span><span class="err">q:</span><span class="w"> </span><span class="err">quantity</span><span class="w">
        </span><span class="err">l:</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">taker</span><span class="w">
        </span><span class="err">f:</span><span class="w"> </span><span class="err">fee</span><span class="w">
        </span><span class="err">fb:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">discount</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='ledgers'>Ledgers</h2>
<p><strong>When there is a new bill, you receive a ledger event</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"ledger"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
         </span><span class="err">i:</span><span class="w"> </span><span class="err">ledger</span><span class="w"> </span><span class="err">id</span><span class="w">
         </span><span class="err">s:</span><span class="w"> </span><span class="err">currency</span><span class="w"> </span><span class="err">symbol</span><span class="w">
         </span><span class="err">p:</span><span class="w"> </span><span class="err">trading</span><span class="w"> </span><span class="err">pair</span><span class="w">
         </span><span class="err">T:</span><span class="w"> </span><span class="err">Bill</span><span class="w"> </span><span class="err">Type</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">Transfer</span><span class="p">,</span><span class="mi">2</span><span class="w"> </span><span class="err">Trade</span><span class="p">,</span><span class="mi">3</span><span class="w"> </span><span class="err">Fee</span><span class="p">,</span><span class="mi">4</span><span class="w"> </span><span class="err">Fund</span><span class="w"> </span><span class="err">fee</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">Adjust</span><span class="w"> </span><span class="err">fund</span><span class="w"> </span><span class="err">fee</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="err">Force</span><span class="w"> </span><span class="err">sub</span><span class="w"> </span><span class="err">hold</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="err">Force</span><span class="w"> </span><span class="err">clear</span><span class="w"> </span><span class="err">hold</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="err">ADL</span><span class="w">
         </span><span class="err">a:</span><span class="w"> </span><span class="err">change</span><span class="w"> </span><span class="err">amount</span><span class="w">
         </span><span class="err">b:</span><span class="w"> </span><span class="err">balance</span><span class="w">
         </span><span class="err">t:</span><span class="w"> </span><span class="err">time</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='deallogs'>DealLogs</h2>
<p><strong>When there is a change in the position size, a dealLog event is received</strong></p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"stream"</span><span class="p">:</span><span class="s2">"dealLog"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:{</span><span class="w">
        </span><span class="err">i:</span><span class="w"> </span><span class="err">'</span><span class="mi">1125899906843599056</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">log</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="err">m:</span><span class="w"> </span><span class="err">'</span><span class="mi">4</span><span class="err">STEPN_USDT'</span><span class="p">,</span><span class="w"> </span><span class="err">pair</span><span class="w">
        </span><span class="err">y:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">log</span><span class="w"> </span><span class="err">type.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">positions</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">reduction</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">reduce</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">risk</span><span class="w"> </span><span class="err">level</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">positions</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">empty</span><span class="w"> </span><span class="err">positions</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="err">ADL</span><span class="w">
        </span><span class="err">p:</span><span class="w"> </span><span class="err">'</span><span class="mi">1125899906842624053</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="err">Positions</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="err">sd:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">direction</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">long</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">short</span><span class="w"> </span><span class="err">positions</span><span class="w">
        </span><span class="err">md:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">mode</span><span class="p">,</span><span class="w"> </span><span class="err">valid</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">cross</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">Isolated</span><span class="w"> </span><span class="err">position</span><span class="w">
        </span><span class="err">hc:</span><span class="w"> </span><span class="mi">3000</span><span class="p">,</span><span class="err">Number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">positions</span><span class="w">
        </span><span class="err">hd:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="err">The</span><span class="w"> </span><span class="err">amount</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">change</span><span class="w">
        </span><span class="err">o:</span><span class="w"> </span><span class="mf">1.3592983336</span><span class="p">,</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">average</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">opened</span><span class="w">
        </span><span class="err">pl:</span><span class="w"> </span><span class="mf">1.3336</span><span class="p">,</span><span class="w"> </span><span class="err">The</span><span class="w"> </span><span class="err">price</span><span class="w"> </span><span class="err">used</span><span class="w">
        </span><span class="err">fi:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">profit</span><span class="w">
        </span><span class="err">f:</span><span class="w"> </span><span class="mf">0.0106688</span><span class="p">,</span><span class="w"> </span><span class="err">fee</span><span class="w">
        </span><span class="err">fb:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="err">fb</span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">Coupon</span><span class="w"> </span><span class="err">credit</span><span class="w"> </span><span class="err">handling</span><span class="w"> </span><span class="err">fee</span><span class="w">
        </span><span class="err">t:</span><span class="w"> </span><span class="mi">1653541169000</span><span class="w"> </span><span class="err">Time</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h1 id='errors'>Errors</h1><h2 id='e08c1d4f9a'>错误码</h2>
<table><thead>
<tr>
<th>Code</th>
<th>描述</th>
<th>Msg</th>
</tr>
</thead><tbody>
<tr>
<td>2003</td>
<td>Cookie 失效</td>
<td>Cookie expired</td>
</tr>
<tr>
<td>2033</td>
<td>操作失败！订单已完成或已撤销</td>
<td>Operation failed! Order completed or canceled</td>
</tr>
<tr>
<td>2034</td>
<td>操作失败！请检查参数是否正确</td>
<td>Operation failed! Please check parameter</td>
</tr>
<tr>
<td>2040</td>
<td>操作失败！没有该订单</td>
<td>Operation failed! No record</td>
</tr>
<tr>
<td>2064</td>
<td>订单撤销中，不能再次撤销</td>
<td>Canceling. Unable to cancel again</td>
</tr>
<tr>
<td>2065</td>
<td>委托价格设置过高，请重新设置价格</td>
<td>Precatory price is exorbitant, please reset</td>
</tr>
<tr>
<td>2066</td>
<td>委托价格设置过低，请重新设置价格</td>
<td>Precatory price is low , please reset</td>
</tr>
<tr>
<td>2067</td>
<td>暂不支持市价单</td>
<td>Limit Order Only</td>
</tr>
<tr>
<td>2068</td>
<td>下单数量不能低于0.0001</td>
<td>Min Amount:0.0001</td>
</tr>
<tr>
<td>2069</td>
<td>市价单无法撤销</td>
<td>Market order can not be canceled</td>
</tr>
<tr>
<td>2078</td>
<td>下单价格非法</td>
<td>unvalid order price</td>
</tr>
<tr>
<td>2085</td>
<td>币种最小下单数量限制</td>
<td>the trade amount is low</td>
</tr>
<tr>
<td>2086</td>
<td>账户资产异常,限制下单</td>
<td>Abnormal account assets, trade is forbiden</td>
</tr>
<tr>
<td>2091</td>
<td>请求过于频繁，请稍后再试</td>
<td>request is too frequency, please try again later</td>
</tr>
<tr>
<td>2092</td>
<td>币种最小下单金额限制</td>
<td>Minimum amount not met</td>
</tr>
<tr>
<td>3000</td>
<td>请求参数错误</td>
<td>Requested parameter incorrect</td>
</tr>
<tr>
<td>3002</td>
<td>参数不能为空</td>
<td>Parameter cannot be null</td>
</tr>
<tr>
<td>3009</td>
<td>推送订阅channel不合法</td>
<td>Illegal subscription channel</td>
</tr>
<tr>
<td>3010</td>
<td>websocket连接异常</td>
<td>websocket connection error</td>
</tr>
<tr>
<td>3011</td>
<td>接口不支持apikey请求方式</td>
<td>Illegal subscribe event</td>
</tr>
<tr>
<td>3012</td>
<td>apikey无效</td>
<td>Interface does not support apikey request method</td>
</tr>
<tr>
<td>3016</td>
<td>交易对错误</td>
<td>Invalid apikey</td>
</tr>
<tr>
<td>3017</td>
<td>推送订阅event不合法</td>
<td>Trading pair error</td>
</tr>
<tr>
<td>3024</td>
<td>apikey权限不足</td>
<td>apikey authorization insufficient</td>
</tr>
<tr>
<td>3025</td>
<td>apikey签名验证失败</td>
<td>apikey signature verification failed</td>
</tr>
<tr>
<td>3026</td>
<td>apikey ip受限制</td>
<td>apikey ip is restricted</td>
</tr>
<tr>
<td>3027</td>
<td>账户没有apikey</td>
<td>No apikey in your account</td>
</tr>
<tr>
<td>3028</td>
<td>账户apikey数量超过了限制数量</td>
<td>Account apikey has exceeded the limit amount</td>
</tr>
<tr>
<td>3029</td>
<td>apikey允许ip数量超过了限制数量</td>
<td>apikey ip has exceeded the limit amount</td>
</tr>
<tr>
<td>3033</td>
<td>查询类请求限制一个cmd</td>
<td>query allow only one cmd</td>
</tr>
<tr>
<td>3034</td>
<td>最大cmd个数限制</td>
<td>maxinum cmds</td>
</tr>
<tr>
<td>3035</td>
<td>cmd请求个数限制</td>
<td>too many cmds</td>
</tr>
<tr>
<td>4000</td>
<td>当前网络连接不稳定，请稍候重试</td>
<td>the network is unstable now, please try again later</td>
</tr>
<tr>
<td>4003</td>
<td>服务器繁忙，请稍后再试</td>
<td>The server is busy, please try again later</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="csharp">csharp</a>
          </div>
      </div>
    </div>
  </body>
      <script>
        const lang_btn = document.getElementById('lang_box');
        const btn_spot_v4 = document.getElementById('btn_spot_v4');
        const btn_spot = document.getElementById('btn_spot');
        const btn_contract = document.getElementById('btn_contract-select');
        const btn_contract_v3 = document.getElementById('btn_contract_v3')
        const btn_contract_v4 = document.getElementById('btn_contract_v4')
        const btn_contract_coin = document.getElementById('btn_contract_coin')

        const btnSpotSelect = document.getElementById('btn_spot-select')
        const spot_select = document.getElementById('spot_select')

        const biboxLogo = document.getElementById('bibox-logo')

        const url = GetUrlRelativePath();

        if(url.indexOf('en') != -1){
          //英文
          btnSpotSelect.innerHTML = 'Spot'
          lang_btn.innerHTML = '中文';
          btn_spot.innerHTML = 'Spot v3';
          btn_spot_v4.innerHTML = 'Spot v4'
          btn_contract_coin.innerHTML = 'Contract Coin';
          btn_contract.innerHTML = 'Contract USDT';
          btn_contract_v3.innerHTML = 'Contract USDT v3';
          btn_contract_v4.innerHTML = 'Contract USDT v4';

          lang_btn.href = url.replace('en/', 'zh/');
          btn_spot.href = btn_spot.href.replace('zh/', 'en/');
          btn_spot_v4.href = btn_spot_v4.href.replace('zh/', 'en/')
          btn_contract_coin.href = btn_contract_coin.href.replace('zh/', 'en/');
          btn_contract_v3.href = btn_contract_v3.href.replace('zh/', 'en/');
          btn_contract_v4.href = btn_contract_v4.href.replace('zh/', 'en/');

          biboxLogo.onclick = function () {
            window.location.href = 'https://www.bibox.tech/en'
          }
        }else{
          //中文
          btnSpotSelect.innerHTML = '现货'
          lang_btn.innerHTML = 'English';
          btn_spot.innerHTML = '现货 v3';
          btn_spot_v4.innerHTML = '现货 v4'
          btn_contract_coin.innerHTML = '币本位永续合约';
          btn_contract.innerHTML = 'U本位永续合约';
          btn_contract_v3.innerHTML = 'U本位永续合约 v3';
          btn_contract_v4.innerHTML = 'U本位永续合约 v4';

          lang_btn.href = url.replace('zh/', 'en/');
          btn_spot.href = btn_spot.href.replace('en/', 'zh/');
          btn_spot_v4.href = btn_spot_v4.href.replace('en/', 'zh/');
          btn_contract_coin.href = btn_contract_coin.href.replace('en/', 'zh/');
          btn_contract_v3.href = btn_contract_v3.href.replace('en/', 'zh/');
          btn_contract_v4.href = btn_contract_v4.href.replace('en/', 'zh/');
          biboxLogo.onclick = function () {
            window.location.href = 'https://www.bibox.tech/zh'
          }
        }

        if(location.href.indexOf('/spot/v4/') > 0){
          btn_spot_v4.className = 'current';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_spot.className = '';
          spot_select.className = spot_select.className + ' current';
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML + ' v4'
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML.replace('v4 v4', 'v4');
        } else if(location.href.indexOf('/spot/v3/') > 0){
          btn_spot.className = 'current';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_spot_v4.className = '';
          spot_select.className = spot_select.className + ' current';
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML + ' v3'
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML.replace('v3 v3', 'v3');
        }
        else if(location.href.indexOf('/futures-coin/') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = 'current';
          btn_contract.className = '';
          btn_spot_v4.className = '';
        }
        else if(location.href.indexOf('/futures/v4') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_contract.innerHTML = btn_contract.innerHTML + ' v4';
          btn_contract_v3.className = '';
          btn_contract_v4.className = 'current';
          btn_spot_v4.className = '';
        }
        else if(location.href.indexOf('/futures/') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = '';
          btn_contract.innerHTML = btn_contract.innerHTML + ' v3';
          btn_contract.className = '';
          btn_contract_v4.className = '';
          btn_contract_v3.className = 'current';
          btn_spot_v4.className = '';
        }

        lang_btn.style.display = 'block';
        function GetUrlRelativePath(){
          let url = document.location.toString();
          let arrUrl = url.split("//");
          let start = arrUrl[1].indexOf("/");
          let relUrl = arrUrl[1].substring(start);
          if(relUrl.indexOf("?") != -1){
            relUrl = relUrl.split("?")[0];
          }
          if(relUrl.indexOf("#") != -1){
            relUrl = relUrl.split("#")[0];
          }
          return relUrl;
    　　}
      </script>
</html>
